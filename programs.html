<!DOCTYPE html>
<!-- vim: set fdm=indent tw=78: --> 
<title>Programs - Read Ruby</title>
<meta charset=utf-8>
<link href=/style rel=stylesheet>
<link rel=license href=//creativecommons.org/licenses/by-nc-sa/2.0/uk/>
<link rel=next href=/expressions>
<link rel='index up' href=/toc>

<section>  
  <h1 id=programs>Programs</h1>

  <section>
    <h1 id=source-files>Source Files</h1>

    <p>Ruby programs are typically stored in plain text files with an
    <code>.rb</code> filename extension.</p>

    <section>
      <aside class=sidenote>
        <span class=sidemark>†</span>A portmanteau of <i>sharp</i> and
        <i>bang</i> (<a href=/references#refWALL00>Wall, Christiansen, &amp;
          Orwant</a>, p. 1001), colloquial terms for the number sign (<code
          class=u title='#'>U＋0023</code>) and the exclamation mark (<code
          class=u title='!'>U＋0021</code>), respectively.
      </aside>    

      <h1 id=shebang>Shebang</h1>

      <p>The <dfn>shebang</dfn><sup>†</sup> is a notation for informing a
      UNIX-like operating system of the interpreter with which a script should
      be executed. If present it must appear as the first line of a source
      file. It begins with a number sign (<code class=u
        title='#'>U＋0023</code>) making it a legal comment line, therefore
      ignored by the interpreter, which is followed by an exclamation mark
      (<code class=u title='!'>U＋0021</code>) then the path to the
      interpreter.

      <p>A typical shebang is <code>#!/usr/bin/env ruby -w</code> which uses
      <code>env</code> to avoid hardcoding the path to the interpreter, and
      passes the <code>-w</code> option to the interpreter to enable warnings.

      <p>If a script containing a shebang is executable it may be executed by
      entering its filename in the shell.
    </section>

    <section>
      <h1 id=source-encoding>Source Encoding</h1>

      <p>The <dfn>source encoding</dfn> is the character encoding of a given
      source file. It is US-ASCII by default. A <code>SyntaxError</code> is
      raised when a source file contains one or more characters invalid in the
      source encoding.

      <p>A file’s source encoding may be specified inline by means of a
      <dfn>coding comment</dfn>: a specially formatted comment that declares
      the encoding of the lines that follow. If omitted, the default source
      encoding is assumed. If a source file contains a <a
        href=#shebang>shebang</a> line, the coding comment must appear on the
      second line; otherwise it must appear on the first.</p>

      <aside class=sidenote>
        <span class=sidemark>†</span>That the coding comment need only
        <em>contain</em> <code>coding</code> allow Ruby to recognise Vim and
        Emacs modelines which declare a file’s encoding. For example, <code>#
          vim: set fileencoding=utf-8 :</code> informs both Vim and Ruby that
        the file is encoded in UTF-8.
      </aside>
      
      <!-- Tabulte encoding names? -->
      <!-- TODO: Example showing relation to Vim/Emacs encoding declarations
      --> 
      <p>The coding comment is a US-ASCII string which begins with a number
      sign (<code class=u title='#'>U＋0023</code>) and contains<sup>†</sup>
      the string <code>coding</code> followed by an equals sign (<code class=u
        title='='>U＋003D</code>) or colon (<code class=u
        title=':'>U＋003A</code>) then the name of the
      source encoding. The encoding name is one of those returned by
      <code>Encoding.name_list</code> written in a case insensitive fashion.

      <p>The source encoding of the currently executing code can be obtained
      with the <a href=/expressions#encoding><code>__ENCODING__</code></a>
      keyword.
    </section>
  </section>

  <section>
    <aside class=sidenote>
      <span class=sidemark>‡</span>There are several alternative
      implementations such as <a href=//jruby.org/>JRuby</a> and <a
        href=//rubini.us/>Rubinius</a>. However, for the purposes of this
      book neither are recommended because, although JRuby is close, they are
      not yet compatible with Ruby 1.9.
    </aside>

    <h1 id=interpreter>Interpreter</h1>

    <p>The <dfn>interpreter</dfn> is the program that executes Ruby source
    code. The reference implementation<sup>‡</sup> of Ruby, or <abbr
      title="Matz’s Ruby Implementation">MRI</abbr>, contains an interpreter
    called <code>ruby</code>.

    <p>The interpreter is typically supplied the filename of a source file as
    an argument, which it then executes, i.e. <code>ruby
      <var>file</var></code>. If it is supplied with the <code>-e</code>
    switch, Ruby source code may be provided on the command line, i.e.
    <code>ruby -e '<var>code</var>'</code>. Often the interpreter is invoked
    implicitly via a <a href=#shebang>shebang line</a>.</p>

    <section>
      <h1 id=warnings>Warnings</h1>

      <p><dfn>Warnings</dfn>— notices of deprecated, ambiguous, or otherwise
      problematic, code— are enabled when the interpreter is given the
      <code>-w</code> switch. For example, Ruby warns when a <a
        href=/expressions#constants>constant</a> that has already been defined
      is assigned to.
    </section>
  </section>

  <section>
    <h1 id=irb>IRB</h1> 
    <!-- Intro to REPL; how to quit; caveats of #inspect output -->

    <p>
  </section>

  <section>
    <h1 id=execution>Execution</h1> <!-- i.e. line by line -->
  </section>


  <section>
    <h1 id=lexical>Lexical Structure</h1>

    <section>
      <aside class=sidenote>
        <code>Ripper</code> is a class in the standard library for parsing and
        analysing Ruby. The <code>Ripper.tokenize</code> method takes a string
        of code as an argument and returns an array of its constituent tokens.
        Experiment with this method in <abbr title="Interactive
          Ruby">IRB</abbr> (<code>irb -rripper</code>) to test your
        assumptions of how tokenization works.
      </aside>

      <h1 id=tokens>Tokens</h1>

      <p><dfn>Tokens</dfn> are <q>the mark or series of marks that denote one
        symbol or word in the language</q> (<a
        href=/references#refFISCHER92>Fischer &amp; Grodzinsky</a>, pp.
      59–62). A Ruby program consists of a combination of the following
      tokens:

      <ul>
        <li><a href=#comments>Comments</a>
        <li><a href=/objects#literals>Literals</a>
        <li>Punctuation
        <li><a href=#identifiers>Identifiers</a>
        <li><a href=#keywords>Keywords</a>
      </ul>
    </section>

    <section>
      <h1 id=comments>Comments</h1>

      <p><dfn>Comments</dfn> are remarks which do not affect the meaning of a
      program. They are introduced with a number sign (<code class=u
        title='#'>U＋0023</code>) and continue until the end of the line: the
      text between <code>#</code> and the end of the line is ignored by the
      interpreter. Comments are not recognised inside of <a
        href=/objects#strings>string</a>/<a href=/objects#regexps>regexp</a>
      literals—they are interpreted literally—however, regexps support an
      alternative form of embedded comment. There is no specific construct for
      multiline comments, but they may be approximated with <a
        href=#embedded-doc>embedded documentation</a>.
    </section>

    <section>
      <h1 id=embedded-doc>Embedded Documentation</h1>

      <p><dfn>Embedded documentation</dfn> is a portion of a source file that
      contains documentation intended for a postprocessor such as
      <code>rdoc</code>, and as such is ignored by the interpreter. It is
      introduced by a line beginning <code>=begin</code>, that is an equals
      sign (<code class=u title='='>U＋003D</code>) followed by the string
      <code>begin</code>, and continue until a line beginning
      <code>=end</code> is encountered.

      <p>Both <code>=begin</code> and <code>=end</code> may be followed by
      arbitrary text, which is included in the embedded documentation, as long
      as it is preceded by a whitespace character. Conventionally, the text
      following <code>=begin </code> names the tool for which the
      documentation is intended.
    </section>

    <section>
      <h1 id=whitespace>Whitespace</h1>

      <p><dfn>Whitespace</dfn> consists only of <code
        class=u>U＋0009</code>–<code class=u>U＋000D</span> and the space
      character (<code class=u title=' '>U＋0020):</p>

      <ul>
        <li><code class=u>U＋0009</code> (horizontal tab)
        <li><code class=u>U＋000A</code> (line feed)
        <li><code class=u>U＋000B</code> (vertical tab)
        <li><code class=u>U＋000C</code> (form feed)
        <li><code class=u>U＋000D</code> (carriage return)
        <li>〈<code class=u>U＋000D</code>,&nbsp;<code class=u>U＋000A</code>〉
        (carriage return followed by line feed)
        <li><code class=u title=' '>U＋0020</code> (space)
      </ul>

      <p>The primary role of whitespace in Ruby syntax is to separate tokens
      and terminate statements. When whitespace is syntactically significant
      it is typically collapsed to a single space. The few areas of syntax
      where whitespace has different semantics are clearly labeled. Newlines
      are used as <a href=#statement-terminators>statement terminators</a>.
    </section>

    <section>
      <h1 id=statement-terminators>Statement Terminators</h1>
      
      <p>Statements may be terminated with a semicolon (<code class=u
        title=';'>U＋003B</code>. More commonly they are terminated by <dfn
        id=newlines>newlines</dfn>: one of the following character sequences:

      <ul>
        <li><code class=u>U＋000A</code> (line feed)
        <li><code class=u>U＋000C</code> (form feed)
        <li><code class=u>U＋000D</code> (carriage return)
        <li>〈<code class=u>U＋000D</code>, <code class=u>U＋000A</code>〉
        (carriage return followed by line feed)
      </ul>
      
      <p>A newline does not terminate a statement if:
      
      <ul>
        <li>It is immediately preceded by a reverse solidus (<code
          class=u title='\'>U＋005C</code>).
        <li>It is preceded by an <a href=/expressions#operators>operator</a>, with optional intervening
        <a href=#whitespace>whitespace</a>.
        <li>It is immediately preceded by a comma (<code class=u
          title=','>U＋002C</code>) or full stop (<code class=u
          title='.'>U＋002E</code>) in a <a href=/messages#expressions>message
          expression</a> or <a href=/objects#arrays>array</a>/<a
          href=/objects#hashes>hash</a> literal, with optional intervening
        whitespace. 
        <li>The first non-whitespace character on the following line is a full
        stop (<code class=u title='.'>U＋002E</code>). (Allows <a
          href=/message#chaining>chained</a> message expressions to span
        lines).
      </ul>
    </section>

    <section>
      <h1 id=punctuation>Punctuation</h1>

      <section>
        <h1 id=ampersands>Ampersands</h1>
      </section>

      <section>
        <h1 id=apostrophes>Apostrophes</h1>
      </section>

      <section>
        <h1 id=asterisks>Asterisks</h1>
      </section>

      <section>
        <h1 id=cicumflex-accents>Circumflex Accents</h1>
      </section>
      
      <section>
        <h1 id=colons>Colons</h1>
      </section>
      
      <section>
        <h1 id=commas>Commas</h1>
      </section>

      <section>
        <h1 id=commercial-ats>Commercial Ats</h1>
      </section>

      <section>
        <h1 id=curly-brackets>Curly Brackets</h1>
      </section>

      <section>
        <h1 id=dollar-signs>Dollar Signs</h1>
      </section>

      <section>
        <h1 id=equals-signs>Equals Signs</h1>
      </section>

      <section>
        <h1 id=exclamation-marks>Exclamation Marks</h1>
      </section>

      <section>
        <h1 id=full-stops>Full Stops</h1>
      </section>

      <section>
        <h1 id=grave-accents>Grave Accents</h1>
      </section>

      <section>
        <h1 id=greater-than>Greater‐Than Signs</h1>
      </section>

      <section>
        <h1 id=hyphen-minus>Hyphen Minus Signs</h1>
      </section>

      <section>
        <h1 id=less-than>Less‐Than Signs</h1>
      </section>

      <section>
        <h1 id=low-lines>Low Lines</h1>
      </section>

      <section>
        <h1 id=newlines>Newlines</h1>
      </section>

      <section>
        <h1 id=number-signs>Number Signs</h1>
      </section>

      <section>
        <h1 id=parentheses>Parentheses</h1>
      </section>

      <section>
        <h1 id=percent-signs>Percent Signs</h1>
      </section>

      <section>
        <h1 id=plus-signs>Plus Signs</h1>
      </section>

      <section>
        <h1 id=question-marks>Question Marks</h1>
      </section>

      <section>
        <h1 id=quotation-marks>Quotation Marks</h1>
      </section>

      <section>
        <h1 id=reverse-solidi>Reverse Solidi</h1>
      </section>

      <section>
        <h1 id=semicolons>Semicolons</h1>
      </section>

      <section>
        <h1 id=solidi>Solidi</h1>
      </section>

      <section>
        <h1 id=square-brackets>Square Brackets</h1>
      </section>

      <section>
        <h1 id=tildes>Tildes</h1>
      </section>

      <section>
        <h1 id=vertical-lines>Vertical Lines</h1>
      </section>
    </section>

    <section>
      <h1 id=identifiers>Identifiers</h1>
      
      <p>An <dfn>identifier</dfn> is the name of a variable or constant. It
      must not contain any US-ASCII character other than the alphanumerics
      (A—Z, a—z, 0–9) and the low line (<code class=u
        title='_'>U＋005F</code>), or begin with a US-ASCII digit. However, it
      may contain any other character legal in the source encoding.</p>
    </section>
  </section>

  <!-- Maybe introduce expressions, link to chapter -->
  <section>
    <h1 id=statements>Statements</h1>
  </section>


  <section>
    <h1 id=block-structure>Block Structure</h1>
  </section>

  <section>
    <h1 id=data><code>__END__</code></h1>
  </section>

  <section>
    <h1 id=require><code>require</code></h1>
  </section>
  
  <section>
    <h1 id=load><code>load</code></h1>
  </section>

  <section>
    <h1 id=keywords>Keywords</h1>
    
    <dl>
      <!-- Is alias an expression given that it always returns nil? -->
      <dt><a href=/methods#aliases><code>alias</code></a> 
      <dd>Creates a copy of an existing method with a new name.
      <dt><a href=/flow#and-operator><code>and</code></a> 
      <dd>Boolean binary operator performing logical AND.
      <dt><a href=/flow#begin-statement><code>begin</code></a> 
      <dd>Introduces a block of code which may have <code>rescue</code>,
      <code>ensure</code>, and <code>else</code> clauses attached.
      <dt><a href=/flow#break-statement><code>break</code></a> 
      <dd>Within a loop or block, transfers control to the statement
      immediately following the construct.
      <dt><a href=/classes#class-keyword><code>class</code></a>
      <dd>Defines a class.
      <dt><a href=/flow#case-statement><code>case</code></a> 
      <dd>Multi-way conditional predicated on the value of a given expression.
      <!-- Is def an expression given that it always returns nil? -->
      <dt><a href=/methods#defining><code>def</code></a> 
      <dd>Defines a method
      <dt><a href=#defined><code>defined?</code></a> 
      <dd>
      <!-- NOTE: Not standalone -->
      <dt><a href=/messages#block-argument><code>do</code></a> <!-- ?? -->
      <dd>Delimits a block literal
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#if-else-clause><code>else</code></a> <!-- rescue else
      clause -->
      <dd>Optional default clause for the <code>case</code>, <code>if</code>,
      <code>unless</code> statements. Optional clause of <code>begin</code>,
      <code>class</code>, <code>def</code>, and <code>module</code> statements
      for use in exception handling.
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#if-elsif-clause><code>elsif</code></a>
      <dd>Optional clause in an <code>if</code> statement.
      <dt><a href=/flow#for><code>in</code></a> <!-- xref for in specifically?
      -->
      <dd>Separates a list of identifiers from the object being iterated in a
      <code>for</code> loop.
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#ensure-clause><code>ensure</code></a>
      <dd>Optional clause of <code>begin</code>, <code>class</code>,
      <code>def</code>, and <code>module</code> statements which is executed
      even if sibling clauses raise an exception.
      <dt><a href=/flow#false><code>false</code></a>
      <dd>Singleton instance of <code>FalseClass</code> representing
      falsehood.
      <dt><a href=/flow#for><code>for</code></a>
      <dd>Looping construct for iterating over an object responding to
      <code>:each</code>.
      <dt><a href=/flow#if-statement><code>if</code></a> <!-- postfix form, also -->
      <dd>Conditional statement and statement modifier.
      <dt><a href=/modules#module-keyword><code>module</code></a>
      <dd>Defines a module.
      <dt><a href=/flow#next-statement><code>next</code></a>
      <dd>Ends the current iteration of a loop or iterator and begins the
      next.
      <dt><a href=/flow#nil><code>nil</code></a>
      <dd>Singleton instance of <code>NilClass</code> representing the
      absence of a value.
      <dt><a href=/flow#not-operator><code>not</code></a>
      <dd>Boolean unary operator performing logical NOT. 
      <dt><a href=/flow#or-operator><code>or</code></a>
      <dd>Boolean binary operator performing logical OR.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#redo-statement><code>redo</code></a>
      <dd>Restarts the current iteration of a loop without re-evaluating the
      conditional.
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#rescue><code>rescue</code></a>
      <dd>Optional clause of <code>begin</code>, <code>class</code>,
      <code>def</code>, or <code>module</code> statements that handles the
      specified exceptions.
      <!-- NOTE: No return value? -->
      <dt><code>retry</code>
      <dd>
      <!-- return should be discussed in Flow > Control Statements -->
      <dt><a href=/methods#return-values><code>return</code></a>
      <dd>Immediately returns control from a method to its caller, along with
      an optional value.
      <dt><a href=/expressions#self><code>self</code></a>
      <dd>Evaluates to the current object.
      <dt><a href=/methods#super><code>super</code></a>
      <dd>When used in a method body, invokes the method from a parent class
      with the same name.
      <dt><a href=/flow#true><code>true</code></a>
      <dd>Singleton instance of <code>TrueClass</code> representing truth.
      <!-- NOTE: No return value -->
      <dt><a href=/methods#undefining><code>undef</code></a>
      <dd>Removes the definition of a given method from the class in which it
      was defined.
      <dt><a href=/flow#unless-statement><code>unless</code></a>
      <dd>Conditional statement and statement modifier.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#until-loop><code>until</code></a>
      <dd>Looping construct.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#when><code>when</code></a>
      <dd>Clause in a <code>case</code> statement.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#while-loop><code>while</code></a>
      <dd>Looping construct.
      <dt><a href=/flow#yield><code>yield</code></a>
      <dd>Transfers control from a method to an associated block then back.
    </dl>
  </section>
</section>
