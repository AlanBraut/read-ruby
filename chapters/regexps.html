<link rel=next href=/enumerables>
<article>
  <h1 id=regexps>Regexps</h1>
    
  <p>A <code>Regexp</code> represents a regular expression: a pattern that
  describes a <code>String</code>. If a <code>String</code> contains the
  pattern described by a given regular expression, it is said to <dfn
    title='regular expression match'>match</dfn>. Therefore, one use of
  regular expressions is
  validation: testing whether a <code>String</code> matches a pattern.</p>

  <figure id=regexp-validation.rb>
    <figcaption>Validating the presence of a pattern with regular expressions
  </figure>

  <p>Another, <a href=/strings#split>introduced</a> in the
  <code>String</code>s chapter, is extracting the portions of a
  <code>String</code> that match a certain pattern.</p>

  <figure id=regexp-split.rb>
    <figcaption>Subdividing a <code>String</code> into sequences separated by
    a regular expression
  </figure>
  
  <p>Similarly, areas of the pattern can be designated as capturing, which
  effectively labels parts of the <code>String</code> so they can be referred
  to after the match.</p>

  <figure id=regexp-capturing.rb>
    <figcaption>Extracting portions of a <code>String</code> that match a
    specific area of a pattern
  </figure>
  
  <p>Further examples of the utility of regular expressions can be found in the
  <a href=/strings><code>String</code>s</a> chapter. In this chapter, we deal
  primarily with the syntax of patterns: how to construct a regular expression
  that matches precisely what is needed.</p>

  <section>
    <h1 id=literals>Literals</h1>

    <figure class=railroad>
      <img id=regexp-literal.png>
      <figcaption>Syntax diagram of the <code>Regexp</code> literal
    </figure>

    <figure class=railroad>
      <img style=float:right id=regexp-options.png>
      <figcaption>Options accepted by the <code>Regexp</code> literal
    </figure>

    <p>The literal is of the form
    <code>/<var>pattern</var>/<var>options</var></code>: a pattern delimited
    by solidi, followed by zero or more single-character <a
      href=#options>option specifiers</a>. If the pattern is to contain either
    of these delimiters literally, they must be escaped with a reverse
    solidus. The construct
    <code>%r{<var>pattern</var>}<var>options</var></code> also constructs a
    <code>Regexp</code>, but in this form <var>pattern</var> may contain
    either solidi or reverse solidi literally, without having to escape
    them.</p>

    <figure id=regexp-literal.rb>
      <figcaption>Constructing a <code>Regexp</code> via a literal
    </figure>
  </section>

  <section>
    <h1 id=options>Options</h1>

    <p>The behaviour of a <code>Regexp</code> can be modified by following the
    literal with one or more of the following option specifiers:</p>

    <table class=border>
      <thead>
        <tr>
          <th>Option
          <th>Effect
      <tbody class=zebra>      
        <tr>
          <td><code>e</code>
          <td>Associate the pattern with the EUC-JP encoding
        <tr>    
          <td><code>i</code>
          <td>Ignore case
        <tr>
          <td><code>m</code>
          <td>Let <code>.</code> match newline characters.
        <tr>    
          <td><code>n</code>
          <td>Associate the pattern with the ASCII-8BIT encoding.
        <tr>    
          <td><code>o</code>
          <td>Only interpolate <code>#{…}</code> constructs the first time this literal is parsed.
        <tr>    
          <td><code>s</code>
          <td>Associate the pattern with the Windows-31J encoding.
        <tr>    
          <td><code>u</code>
          <td>Associate the pattern with the UTF-8 encoding.
        <tr>    
          <td><code>x</code>
          <td>Enable <a href=#readability>free-spacing</a> mode.
    </table>

    <figure id=regexp-options.rb>
      <figcaption>Modifying the behaviour of a <code>Regexp</code> with
      options
    </figure>
    
    <p>Options <code>i</code>, <code>m</code>, and <code>x</code>, may also be
    applied to a specific group rather than the pattern as a whole, with the
    syntax described in <a href=#groups>Grouping</a>.
  </section>

  <section>
    <h1 id=matching>Matching</h1>

    <p>A <code>Regexp</code> may be matched against a <code>String</code> by
    supplying the latter as an argument to <code>Regexp#match</code> or
    <code>Regexp#=~</code>. <code>String#match</code> and
    <code>String#=~</code> behave in the same way, <i>mutatis mutandis</i>. 

    <p>The <code>#match</code> methods return <a
      href=#matchdata><code>MatchData</code></a> objects if the match
    succeeded, whereas the <code>#=~</code> methods return the character
    offset in the <code>String</code> where the match began. They all return
    <code>nil</code> if the <code>String</code> didn’t match.</p>

    <!-- !~ ; both operator methods -->
    <figure id=regexp-matching.rb>
      <figcaption>Matching a regular expression against a <code>String</code>
    </figure>
  </section>

  <section>
    <h1 id=metacharacters>Metacharacters</h1>

    <p>In the context of a pattern, a character is either interpreted
    literally or as a <dfn>metacharacter</dfn>. A literal character matches
    itself, whereas a metacharacter has another meaning. To force a
    metacharacter to be interpreted literally it must be preceded by a reverse
    solidus (<code>\</code>).</p>

    <table class=border>
      <thead>
        <tr>
          <th>Metacharacter
          <th>Meaning
      <tbody class=zebra>
        <tr>
          <td><a href=#anchors><code>^</code></a>
          <td>Start of line anchor
        <tr>
          <td><a href=#anchors><code>$</code></a>
          <td>End of line anchor  
        <tr>
          <td><a href=#readability><code>#</code></a>
          <td>Introduces a comment if the <code>x</code> option is given
        <tr>
          <td><code>#{</code>…<code>}</code>
          <td>Interpolates an expression
        <tr>
          <td><a href=#groups><code>(</code>…<code>)</code></a>
          <td>Encloses a <a href=#groups>group</a>  
        <tr>
          <td><a href=#quantifiers><code>*</code></a>
          <td>Greedy <a href=#quantifiers>quantifier</a>: preceding atom may
            occur any number of times  
        <tr>
          <td><a href=#quantifiers><code>+</code></a>
          <td>Greedy <a href=#quantifiers>quantifier</a>: preceding atom
            occurs at least once  
        <tr>
          <td><code>-</code>
          <td>Separates a range inside a <a href=#character-classes>character
              class</a>  
        <tr>
          <td><code>.</code>
          <td>Matches almost any character  
        <tr>
          <td><a href=#quantifiers><code>?</code></a>
          <td>Greedy <a href=#quantifiers>quantifier</a>: preceding atom
            occurs 0 or 1 times  
        <tr>
          <td><a href=#classes><code>[</code>…<code>]</code></a>
            <td>Encloses a <a href=#classes>character class</a>  
        <tr>
          <td><code>/</code>
          <td>Escapes the character that follows  
        <tr>
          <td><a href=#quantifiers><code>{</code>…<code>}</code></a>
          <td>Interval
        <tr>
          <td><a href=#alternation><code>|</code></a>
          <td>Alternation  
    </table>
  </section>

  <section>
    <h1 id=escapes>Escapes</h1>

    <p>In addition to to the metacharacter escapes already mentioned, a
    pattern may also contain <a href=/strings#escapes><code>String</code>
      escapes</a>, as well as those summarised in the following table:

    <table class=border>
      <thead>
        <tr>
          <th>Escape
          <th>Meaning
      <tbody class=zebra>
        <tr>
          <td><a href=#captures><code>\1</code>&ndash;<code>\9</code></a>
          <td>Back-reference to a numbered group  
        <tr>
          <td><a href=#anchors><code>\A</code></a>
          <td>Start of <code>String</code> anchor 
        <tr>
          <td><a href=#anchors><code>\b</code></a>
          <td>Word boundary 
        <tr>
          <td><a href=#anchors><code>\B</code></a>
          <td><em>Not</em> <code>\b</code> 
        <tr>
          <td><code>\d</code>
          <td>Decimal digit: 0&ndash;9 
        <tr>
          <td><code>\D</code>
          <td><em>Not</em> <code>\d</code> 
        <tr>
          <td><code>\g&lt;<var>name</var>&gt;</code>
          <td>Sub-expression call for <var>name</var>
        <tr>
          <td><code>\G</code>
          <td>Start of match or end of previous match
        <tr>
          <td><code>\h</code>
          <td>Hexadecimal digit
        <tr>
          <td><code>\H</code>
          <td>Not <code>\h</code> 
        <tr>
          <td><a href=#captures><code>\k&lt;<var>name</var>&gt;</code></a>
          <td>Back-reference to group named or numbered <var>name</var>
        <tr>
          <td><a href=#properties><code>\p{<var>name</var>}</code></a>
          <td>A character with the <a href=#properties>Unicode property</a>
            <var>name</var>
        <tr>
          <td><a href=#properties><code>\P{<var>name</var>}</code></a>
          <td>A character without the <a href=#properties>Unicode property</a>
            <var>name</var>
        <tr>
          <td><code>\Q</code>
          <td>Quote metacharacters that follow
        <tr>
          <td><code>\s</code>
          <td>Whitespace 
        <tr>
          <td><code>\S</code>
          <td><em>Not</em> <code>\s</code> 
        <tr>
          <td><code>\w</code>
          <td>Word character 
        <tr>
          <td><code>\W</code>
          <td><em>Not</em> <code>\w</code> 
        <tr>
          <td><a href=#anchors><code>\Z</code></a>
          <td>End of <code>String</code> or before <code>String</code>-ending
            newline
        <tr>
          <td><a href=#anchors><code>\z</code></a>
          <td>Absolute end-of <code>String</code> anchor
    </table>

    <!-- Regexp.quote and \Q -->
  </section>

  <section>
    <h1 id=groups>Grouping</h1>
    
    <p>A balanced pair of parentheses are meta-characters which group and/or
    capture the characters they enclose. Grouping allows the enclosed to be
    treated as an atomic whole such that meta-characters directly following
    the closing parenthesis act on the whole. 

    <p>It also allows the <code>i</code>, <code>m</code>, and <code>x</code>
    <a href=#options>option specifiers</a> to be applied to a specific
    group, rather than the pattern as a whole. The opening parenthesis is
    immediately followed by <code>?<var>options</var>:</code>, where
    <var>options</var> is one or more of the aforementioned option specifiers.
    If <var>options</var> is omitted, i.e. a group begins with
    <code>(?:</code>, it is non-capturing, as explained in the following
    section.</p>

    <figure id=regexp-group-options.rb>
      <figcaption>Applying options to a specific group
    </figure>
  </section>

  <section>
    <h1 id=captures>Capturing</h1>

    <p>Capturing is the extraction of specific parts of the text being matched
    so it can be referred to later, from within the pattern or the surrounding
    program. As explained above, a <a href=#groups>group</a> captures unless
    its opening parenthesis is directly followed by
    <code>?<var>options</var>:</code>, where <var>options</var> is zero or
    more of the specifiers <code>i</code>, <code>m</code>, or <code>x</code>. 
    
    <p>A capturing group can be referred to later in the pattern by means of a
    <dfn>back-reference</dfn>. The back-reference <code>\<var>d</var></code>,
    where <var>d</var> is a decimal digit between one and nine, refers to the
    <var>d</var><sup>th</sup> capturing group.  Captures can be referred to by
    name if the opening parenthesis is followed by
    <code>?&lt;<var>name</var>&gt;</code>.  The back-reference
    <code>\&lt;<var>name</var>&gt;</code> refers to the capturing group named
    <var>name</var>. If <var>name</var> is a decimal number, it refers to the
    corresponding numbered capture group, enabling numbered back-references to
    be used even when there are more than nine capture groups.  However, named
    capture groups and numbered capture groups cannot both be used in the same
    pattern.

    <p>The text captured by a specific capture group can be retrieved after
    the match from the corresponding <a
      href=#matchdata><code>MatchData</code></a> object. The text captured by
    a numbered group in the last match is also available in the global
    variable <code>$<var>d</var></code>, where <var>d</var> is the group
    number between one and nine.</p>

    <figure id=regexp-backreferences.rb>
      <figcaption>Using back-references to refer to captured text
    </figure> 

    <p>If a <code>Regexp</code> literal is successfully matched against a
    <code>String</code> with <code>Regexp#=~</code>, a local variable will be
    initialized for each named group to hold its captured text.</p>

    <figure id=regexp-backreferences-lvars.rb>
      <figcaption>Automatically initializing local variables to hold the
      results of a match.
    </figure>
  </section>

  <section>
    <h1 id=quantifiers>Quantifiers</h1>

    <p>A literal character, group, or character class may be followed by a
    <dfn>quantifier</dfn> meta-character which specifies how many consecutive
    occurrences are required at that point in the pattern. <code>+</code>
    requires at least one; <code>?</code>, zero or one; and <code>*</code>,
    zero or more. Alternatively, an <dfn title='regexp
      interval'>interval</dfn> may be given, enclosed in a pair of curly
    brackets. An interval of the form <code>{<var>n</var>}</code> requires
    exactly <var>n</var> occurrences; <code>{<var>n</var>,}</code>, at least
    <var>n</var>; and <var>{,<var>n</var>}</code>, at most <var>n</var>.
    <code>{<var>min</var>,<var>max</var>}</code> requires between
    <var>min</var> and <var>max</var> occurrences.</p>

    <figure id=regexp-quantifiers.rb>
      <figcaption>Quantifying atoms in a regular expression
    </figure>

    <p>The above quantifiers are termed <dfn title='greedy
      quantifiers'>greedy</dfn> because they consume as many characters as
    possible; in contrast, a <dfn title='lazy quantifier'>lazy</dfn>
    quantifier consumes as few characters as possible. The <code>+</code>,
    <code>?</code>, and <code>*</code> quantifiers are made lazy when
    immediately followed by a question mark.</p>


    <figure id=lazy-quantifiers.rb>
      <figcaption>Lazily quantifying atoms in a regular expression
    </figure>
  </section>

  <section>
    <h1 id=classes>Character Classes</h1>

    <p>A character class specifies a set of characters, one of which must
    appear at that point in the pattern, enclosed within a pair of square
    brackets. The characters are specified literally, one after the other. A
    range of consecutive characters may be abbreviated with the notation
    <code><var>start</var>-<var>end</var></code>: the first character in the
    range separated from the last by a hyphen minus sign (<code class=u
      title='-'>U＋002D</code>). If the first character after the left square
    bracket is a circumflex accent (<code class=u title='^'>U＋005E</code>),
    the class is inverted: it matches any character except those listed.
    Inside a character class, therefore, the hyphen-minus sign and circumflex
    accent are metacharacters, so to be matched literally, the former must
    appear directly before the right square bracket, and the latter at any
    position other than the first.  Alternatively, either can be escaped with
    a reverse solidus.  

    <p>The following predefined character classes are also available. They are
    specified as <code>[:<var>name</var>:]</code>, and must appear within
    another character class. For example, <code>[[:alpha:]]</code> represents
    alphabetical characters, and <code>[[:alpha:]2-4]</code> represents
    alphabetical characters and the digits <i>2</i>, <i>3</i>, and
    <i>4</i>.</p>

    <dl>
      <dt id=alnum><code>[[:alnum:]]</code>
      <dd>Characters with the Unicode properties <i>Alphabetic</i> or <i>Decimal Number</i>
      <dt id=alpha><code>[[:alpha:]]</code>
      <dd>Characters with the Unicode property <i>Alphabetic</i>
      <dt id=blank><code>[[:blank:]]</code>
      <dd>Characters with the Unicode property <i>White Space</i>, excluding:
        <ul>
          <li>Characters with the Unicode properties <i>Line Separator</i> or
          <i>Paragraph Separator</i>
          <li><i>Line Feed (LF)</i> (<code class=u title=>U＋000A</code>)
          <li><i>Line Tabulation</i> (<code class=u title=>U＋000B</code>)
          <li><i>Form Feed (FF)</i> (<code class=u title=>U＋000C</code>)
          <li><i>Carriage Return (CR)</i> (<code class=u title=>U＋000D</code>)
          <li><i>Next Line (NEL)</i> (<code class=u title=>U＋0085</code>)
        </ul>
      <dt id=cntrl><code>[[:cntrl:]]</code>
      <dd>Characters with the Unicode General Category <i>Cc</i>
      (<i>Control</i>)
      <dt id=digit><code>[[:digit:]]</code>
      <dd>Characters with the Unicode property <i>Decimal Number</i>
      <dt id=graph><code>[[:graph:]]</code>
      <dd>Any character except for characters…:
        <ul>
          <li>with the Unicode property <i>White Space</i>.
          <li>with the Unicode general categories <i>Cc</i>
          (<i>Control</i>), <i>Cs</i> (<i>Surrogate</i>), or <i>Cn</i>
          (<i>Unassigned</i>).
        </ul>
      <dt id=lower><code>[[:lower:]]</code>
      <dd>Characters with the Unicode property <i>Lowercase</i>
      <dt id=print><code>[[:print:]]</code>
      <dd>Characters represented by <code>[[:graph:]]</code> or
      <code>[[:blank:]]</code>, excluding those represented by
      <code>[[:cntrl:]]</code>.
      <dt id=punct><code>[[:punct:]]</code>
      <dd>Characters with the Unicode property <i>Punctuation</i>
      <dt id=space><code>[[:space:]]</code>
      <dd>Characters with the Unicode property <i>White Space</i>.
      <dt id=upper><code>[[:upper:]]</code>
      <dd>Characters with the Unicode property <i>Uppercase</i>
      <dt id=xdigit><code>[[:xdigit:]]</code>
      <dd>Digit allowed in a hexadecimal number (i.e., 0-9a-fA-F)
      <dt id=word><code>[[:word:]]</code>
      <dd>Characters with…
        <ul>
          <li>the Unicode properties <i>Alphabetic</i> or <i>Decimal Number</i>.
          <li>the Unicode general categories <i>M</i> (<i>Mark</i>) or
          <i>Pc</i> (<i>Connector Punctuation</i>).
        </ul>
      <dt id=ascii><code>[[:ascii:]]</code>
      <dd>A character in the ASCII character set, i.e.〈<code
        class=u>U＋0000</code>, <code class=u>U＋007F</code>〉
    </dl>

    <figure id=regexp-classes.rb>
      <figcaption>Matching characters with character classes
    </figure>
    <!-- [ && [^ ]] -->
  </section>


  <section>
    <h1 id=alternation>Alternation</h1>

    <p>A vertical line is a meta-character specifying that either the
    expression to its right, or that to its left, must match. It is usually
    used inside a parenthetical.</p>

    <figure id=regexp-alternation.rb>
      <figcaption>Matching one expression or the other
    </figure>
  </section>

  <section>
    <h1 id=matchdata><code>MatchData</code></h1>

    <p>A <code>MatchData</code> object encapsulates information about a match,
    providing access to the captures and matched text. It is returned by
    <code>Regexp#match</code> and <code>String#match</code>, and the
    <code>MatchData</code> object corresponding to the last match is available
    as <code>$~</code>.

    <code>MatchData#[]</code> returns the text captured by the capture group
    given as a <code>Symbol</code>, for a named group, or an
    <code>Integer</code>.</p>
  </section>  

  <section>
    <h1 id=anchors>Anchoring</h1>

    <p>A regular expression matches a <code>String</code> if the former is
    <em>contained</em> in the latter. For example, <code>/\d/</code> matches
    <code>"2"</code>, as well as <code>"2 by 4"</code> and <code>"DoB:
      19/2/1922"</code>. Alternatively, a pattern may be <dfn title='regular
      expression anchor'>anchored</dfn> to a specific portion of the
    <code>String</code>. Whereas many of the metacharacters introduced so far
    match sequences of characters, anchors match positions.

    <table class=border>
      <thead>
        <tr>
          <th>Anchor
          <th>Position in <code>String</code>
      <tbody class=zebra>      
        <tr>
          <td><code>^</code>
          <td>Start or after newline 
        <tr>
          <td><code>\A</code>
          <td>Start
        <tr>
          <td><code>$</code>
          <td>End or before newline 
        <tr>
          <td><code>\Z</code>
          <td>End or before last newline
        <tr>
          <td><code>\z</code>
          <td>End
        <tr>
          <td><code>\b</code>
          <td>Word boundary
        <tr>
          <td><code>\B</code>
          <td>Non-word boundary
    </table>

    <p>The <dfn>word boundary</dfn> referred to in the table above is a
    position before a word, where <i>word</i> is simply: <code>/[[:word:]]+/</code>.
    Therefore, <code>\b</code> matches a word character that is not preceded
    by a word character. This is quite different from
    <code>/[^[:word:]][[:word:]]/</code> because <code>\b</code> matches a
    position without consuming any characters. Indeed, the pathological
    pattern <code>/\b/</code> matches <code>"a"</code> at position 0, i.e. the
    non-word character need not even exist.</p>

    <figure id=regexp-anchors.rb>
      <figcaption>Anchoring a match to a specific position
    </figure>
  </section>

  <section>
    <h1 id=zero-width>Zero-Width Assertions</h1>

    <p>Inasmuch as anchors never consume any characters, they are a variety of
    a more general concept: the <dfn>zero-width assertion</dfn>. The latter
    require a given sub-expression to appear, or not appear, in the position
    preceding, or following, the assertion. That is, they vary across two axis
    as illustrated below.

    <table class=border>
      <thead>
        <tr>
          <th>Syntax
          <th>Name
          <th>Assertion    
      <tbody class=zebra>      
        <tr>
          <td><code>(?=<var>exp</var>)</code>
          <td>Positive look-ahead  
          <td><var>exp</var> must follow   
        <tr>
          <td><code>(?!<var>exp</var>)</code>
          <td>Negative look-ahead  
          <td><var>exp</var> can’t follow   
        <tr>
          <td><code>(?&lt;=<var>exp</var>)</code>
          <td>Positive look-behind  
          <td><var>exp</var> must precede   
        <tr>
          <td><code>(?&lt;!<var>exp</var>)</code>
          <td>Negative look-behind  
          <td><var>exp</var> can’t precede   
    </table>

    <figure id=regexps-zero-width.rb>
      <figcaption>Using zero-width assertions in regular expressions.
    </figure>
  </section>

  <section>
    <h1 id=readability>Readability</h1>

    <p>Longer patterns tend to be harder to comprehend, increasing the
    likelihood of errors. This can be avoided by adhering the following
    principles:
    
    <dl>
      <dt>Named groups are self-documenting
      <dd>By using named groups instead of numbered groups, a capture
      describes its purpose.
      <dt>Free-spacing mode allows complex patterns to be formatted clearly
      <dd>The <code>x</code> option causes literal whitespace and comments to
      be ignored, allowing a pattern to be commented and laid out over
      multiple lines.
      <dt>Outside of free-spacing mode, comments are still useful
      <dd>The contents of a group beginning <code>(?#</code> are ignored,
      allowing comments to be interspersed with the pattern.
      <dt>Long patterns can be built from smaller parts with interpolation
      <dd>When working with particularly complicated patterns, consider
      constructing independent regular expressions for each sub-expression,
      then interpolating them into one large pattern.
    </dl>

    <figure id=regexp-readability.rb>
      <figcaption>A naïve pattern to match a human name
    </figure>
  </section>

  <section>
    <h1 id=encoding>Encoding</h1>

    <p>A <code>Regexp</code> is associated with an encoding which must be
    compatible with that of the <code>String</code> it is matched against.
    By default a <code>Regexp</code> has the same encoding as the source
    file in which it is contained, with the following exceptions:

    <ul>
      <li>An ASCII-only Regexp has the encoding US-ASCII when the source
      encoding is ASCII-compatible.
      <li>An encoding option has been specified, in which case the
      corresponding encoding is used, as follows:
        <dl class=inline>
          <dt><code>u</code><dd>UTF-8
          <dt><code>e</code><dd>EUC-JP
          <dt><code>s</code><dd>Windows-31J
          <dt><code>n</code><dd>ASCII-8BIT
        </dl>
      <li>The use of Unicode character escapes within a pattern force the
      <code>Regexp</code> to have UTF-8 encoding.
    </ul>

    <p>In addition to the single-letter encoding options described above, a
    <code>Regexp</code> can be encoded in any supporting encoding. This
    requires the <code>Regexp</code> to be constructed with
    <code>Regexp.new</code>, passing it the pattern as a <code>String</code>
    associated with the desired encoding. The same technique, <i>mutatis
      mutandis</i>, can be used with <code>String#force_encoding</code> to
    associate the <code>Regexp</code> with a different encoding.</p>

    <figure id=regexp-specify-encoding.rb>
      <figcaption>Initially, this <code>Regexp</code> adopts the source
      encoding. Passing <code>Regexp.new</code> the pattern encoded as
      ISO-8859-1 creates a regexp with the same pattern and the given
      encoding.
    </figure>

    <section>
      <h1 id=fixed-encoding>Fixed Encoding</h1>

      <p>The encoding of a <code>Regexp</code> is said to be <dfn
        title='fixed encoding'>fixed</dfn> if its encoding and/or pattern is
      incompatible with ASCII. This is significant because a
      <code>Regexp</code> with a non-fixed encoding can match any
      <code>String</code> whose encoding is ASCII-compatible. The
      <code>Regexp#fixed_encoding?</code> predicate returns
      <code>true</code> if its receiver’s encoding is fixed;
      <code>false</code> otherwise.
    </section>
  </section>

  <section>
    <h1 id=properties>Character Properties</h1>

    <p>A generalization of pre-defined <a href=#classes>character classes</a>
    is the Unicode property escape. The construct
    <code>\p{<var>property</var>}</code> represents characters with the
    property <var>property</var>; while the construct
    <code>\P{<var>property</var>}</code> represents its inverse.
    <var>property</var> is a case-insensitive string, in which the space and
    low line characters are ignored. For example,
    <code>\p{Lowercase_Letter}</code>, <code>\p{lowercase letter}</code>, and
    <code>\p{lowercaseletter}</code>, are all equivalent.</p>
    
    <p>The majority of property names correspond to Unicode properties, but
    Ruby also defines the following:

    <dl>
      <dt><i>Newline</i>
      <dd>Comprises solely of <code>"\n"</code> (<code class=u>U＋000A</code>).
      <dt><i>Any</i>
      <dd>Any Unicode character:〈<code
        class=u>U＋0000</code>, <code class=u>U＋10FFFF</code>〉.
      <dt><i>Assigned</i>
      <dd>Equivalent to <code>/[\p{Any}\P{Cn}]/</code>, i.e.
      any character that has been assigned a codepoint.
    </dl>

    <p>In addition, the names of the pre-defined character classes introduced <a
      href=#classes>above</a>, are also valid properties. They have the
    same semantics as previously noted. For example, <code>/\p{Digit}/</code>
    is equivalent to <code>/[[:digit:]]/</code>. They are as follows:

    <ul class=comma>
      <li><a href=#alnum><i>Alnum</i></a>
      <li><a href=#alpha><i>Alpha</i></a>
      <li><a href=#any><i>Any</i></a>
      <li><a href=#ascii><i>Ascii</i></a>
      <li><a href=#blank><i>Blank</i></a>
      <li><a href=#cntrl><i>Cntrl</i></a>
      <li><a href=#digit><i>Digit</i></a>
      <li><a href=#graph><i>Graph</i></a>
      <li><a href=#lower><i>Lower</i></a>
      <li><a href=#print><i>Print</i></a>
      <li><a href=#punct><i>Punct</i></a>
      <li><a href=#space><i>Space</i></a>
      <li><a href=#upper><i>Upper</i></a>
      <li><a href=#word><i>Word</i></a>
      <li><a href=#xdigit><i>Xdigit</i></a>
    </ul>

    <section>
      <h1 id=general-categories>General Categories</h1>
      
      <p>The Unicode general categories, specified either by abbreviation or
      long name, are all valid properties. They represent all characters
      assigned the given category. If <var>property</var> comprises only a
      single character, it represents all general categories whose
      abbreviations begin with that character. For example,
      <code>\p{Lu}</code> and <code>\p{Uppercase Letter}</code> are
      equivalent, while <code>\p{L}</code> represents characters from
      categories <i>Lu</i>, <i>Ll</i>, <i>Lt</i>, <i>Lm</i>, and <i>Lo</i>.

      <!-- Reference UAX#44 -->
      <table class=border>
        <thead>
          <tr>
            <th>Abbreviation
            <th>Long Name
            <th>Description   
          <tbody class=zebra>
            <tr>
              <td>Lu
              <td>Uppercase_Letter
              <td>Uppercase letter
            <tr>
              <td>Ll
              <td>Lowercase_Letter
              <td>Lowercase letter
            <tr>
              <td>Lt
              <td>Titlecase_Letter
              <td>Digraphic character, with first part uppercase
            <tr>
              <td>Lm
              <td>Modifier_Letter
              <td>Modifier letter
            <tr>      
              <td>Lo
              <td>Other_Letter
              <td>Remaining letters, e.g. syllables and ideographs
            <tr>
              <td>Mn
              <td>Nonspacing_Mark
              <td>Non-spacing combining mark (zero advance width)
            <tr>
              <td>Mc
              <td>Spacing_Mark
              <td>Spacing, combining mark (positive advance width)
            <tr>
              <td>Me
              <td>Enclosing_Mark
              <td>Enclosing combining mark
            <tr>
              <td>Nd
              <td>Decimal_Number
              <td>Decimal digit
            <tr>
              <td>Nl
              <td>Letter_Number
              <td>Letter-like numeric character
            <tr>
              <td>No
              <td>Other_Number
              <td>Another type of numeric character
            <tr>
              <td>Pc
              <td>Connector_Punctuation
              <td>Connecting punctuation mark
            <tr>
              <td>Pd
              <td>Dash_Punctuation
              <td>Dash or hyphen punctuation mark
            <tr>
              <td>Ps
              <td>Open_Punctuation
              <td>Opening punctuation mark (of a pair)
            <tr>
              <td>Pe
              <td>Close_Punctuation
              <td>Closing punctuation mark (of a pair)
            <tr>
              <td>Pi
              <td>Initial_Punctuation
              <td>Initial quotation mark
            <tr>
              <td>Pf
              <td>Final_Punctuation
              <td>Final quotation mark
            <tr>
              <td>Po
              <td>Other_Punctuation
              <td>Another type of punctuation mark
            <tr>
              <td>Sm
              <td>Math_Symbol
              <td>Mathematical symbol
            <tr>
              <td>Sc
              <td>Currency_Symbol
              <td>Currency sign
            <tr>
              <td>Sk
              <td>Modifier_Symbol
              <td>Non-letter-like modifier symbol
            <tr>
              <td>So
              <td>Other_Symbol
              <td>Another type of symbol
            <tr>
              <td>Zs
              <td>Space_Separator
              <td>Space character (of non-zero width)
            <tr>
              <td>Zl
              <td>Line_Separator
              <td>Line separator (<code class=u title='\n'>U＋2028</code>)
            <tr>
              <td>Zp
              <td>Paragraph_Separator
              <td>Paragraph separator (<code class=u title='\n'>U＋2029</code>)
            <tr>
              <td>Cc
              <td>Control
              <td>A C0 or C1 control code
            <tr>
              <td>Cf
              <td>Format
              <td>Format control character
            <tr>
              <td>Cs
              <td>Surrogate
              <td>Surrogate code point
            <tr>
              <td>Co
              <td>Private_Use
              <td>Private-use character
            <tr>
              <td>Cn
              <td>Unassigned
              <td>Reserved, unassigned code point or a non-character codepoint
      </table>
    </section>

    <section>
      <h1 id=simple-properties>Simple Properties</h1>

      <p>A Unicode simple-i.e. non-<a
        href=#derived-properties>derived</a>-property is any of the following,
      and represents all characters with that property:

      <dl>
        <dt><i>ASCII Hex Digit</i>
        <dd><q>ASCII characters commonly used for the representation of
          hexadecimal numbers.</q> (<a href=/references#refUAX44><cite>UAX
            #44: Unicode Character Database</cite></a>)
        <dt><i>Bidi Control</i>
        <dd><q>Format control characters which have specific functions in the
        <a href=//www.unicode.org/reports/tr9/>Unicode Bidirectional
          Algorithm</a>.</q> (<i>ibid.</i>)
        <dt><i>Dash</i>
        <dd><q>Punctuation characters designated as dashes in the Unicode
          Standard, plus their compatibility equivalents.</q> (<i>ibid.</i>)
        <dt><i>Deprecated</i>
        <dd><q>Unicode characters whose use is strongly discouraged.</q>
        (<i>ibid.</i>)
        <dt><i>Diacritic</i>
        <dd><q>Characters that linguistically modify the meaning of another
          character to which they apply.</q> (<i>ibid.</i>)
        <dt><i>Extender</i>
        <dd><q>Characters whose principal function is to extend the value or
          shape of a preceding alphabetic character.</q> (<i>ibid.</i>)
        <dt><i>Hex Digit</i>
        <dd><q>Characters commonly used for the representation of hexadecimal
          numbers, plus their compatibility equivalents.</q> (<i>ibid.</i>)
        <dt><i>Hyphen</i>
        <dd><q>Dashes which are used to mark connections between pieces of words,
          plus the Katakana middle dot.</q> (<i>ibid.</i>)
        <dt><i>IDS Binary Operator</i>
        <dt><i>IDS Trinary Operator</i>
        <dd><q>Used in Ideographic Description Sequences.</q> (<i>ibid.</i>)
        <dt><i>Ideographic</i>
        <dd><q>Characters considered to be CJKV (Chinese, Japanese, Korean, and
          Vietnamese) ideographs.</q> (<i>ibid.</i>)
        <dt><i>Join Control</i>
        <dd><q>Format control characters which have specific functions for
          control of cursive joining and ligation.</q> (<i>ibid.</i>)
        <dt><i>Logical Order Exception</i>
        <dd><q>There are a small number of characters that do not use logical
          order. These characters require special handling in most
          processing.</q> (<i>ibid.</i>)
        <dt><i>NonCharacter Code Point</i>
        <dd><q>Code points permanently reserved for internal use.</q> (<i>ibid.</i>)
        <dt><i>Other Alphabetic</i>
        <dd><q>Used in deriving the <i>Alphabetic</i> property.</q> (<i>ibid.</i>)
        <dt><i>Other Default Ignorable Code Point</i>
        <dd><q>Used in deriving the <i>Default Ignorable Code Point</i>
          property.</q> (<i>ibid.</i>)
        <dt><i>Other Grapheme Extend</i>
        <dd><q>Used in deriving the <i>Grapheme Extend</i> property.</q>
        (<i>ibid.</i>)
        <dt><i>Other ID Continue</i>
        <dd><q>Used for backward compatibility of <i>ID Continue</i>.</q>
        (<i>ibid.</i>)
        <dt><i>Other ID Start</i>
        <dd><q>Used for backward compatibility of <i>ID Start</i>.</q>
        (<i>ibid.</i>)
        <dt><i>Other Lowercase</i>
        <dd><q>Used in deriving the <i>Lowercase</i> property.</q>
        (<i>ibid.</i>)
        <dt><i>Other Math</i>
        <dd><q>Used in deriving the <i>Math</i> property.</q> (<i>ibid.</i>)
        <dt><i>Other Uppercase</i>
        <dd><q>Used in deriving the <i>Uppercase</i> property.</q>
        (<i>ibid.</i>)
        <dt><i>Pattern Syntax</i>
        <dt><i>Pattern White Space</i>
        <dd><q>Used for pattern syntax as described in <a
            href=//www.unicode.org/reports/tr31/>UAX #31: Unicode Identifier
            and Pattern Syntax</a></q> (<i>ibid.</i>)
        <dt><i>Quotation Mark</i>
        <dd><q>Punctuation characters that function as quotation marks.</q>
        (<i>ibid.</i>)
        <dt><i>Radical</i>
        <dd><q>Used in Ideographic Description Sequences.</q> (<i>ibid.</i>)
        <dt><i>STerm</i>
        <dd><q>Sentence Terminal. Used in <a
            href=//www.unicode.org/reports/tr29/>UAX #29: Unicode Text
            Segmentation</a></q> (<i>ibid.</i>) 
        <dt><i>Soft Dotted</i>
        <dd><q>Characters with a “soft dot”, like i or j. An accent placed on
          these characters causes the dot to disappear.</q> (<i>ibid.</i>)
        <dt><i>Terminal Punctuation</i>
        <dd><q>Punctuation characters that generally mark the end of textual
          units.</q> (<i>ibid.</i>)
        <dt><i>Unified Ideograph</i>
        <dd><q>Used in Ideographic Description Sequences.</q> (<i>ibid.</i>)
        <dt><i>Variation Selector</i>
        <dd><q>Indicates characters that are Variation Selectors. See <a
            href=//www.unicode.org/reports/tr37/>UAX #37: Unicode Ideographic
            Variation Database</a> for more details.</q> (<i>ibid.</i>)
        <dt><i>White Space</i>
        <dd><q>Separator characters and control characters which should be
          treated by programming languages as "white space" for the purpose of
          parsing elements.</q> (<i>ibid.</i>)
      </dl>
    </section>

    <section>
      <h1 id=derived-properties>Derived Properties</h1>

      <p>The Unicode derived properties are defined by reference to simple
      properties and general categories, and are all valid property names.
      They are as follows:

      <dl>
        <dt><i>Math</i>
        <dd>Equivalent to <code>/[\p{Sm}\p{Other Math}]/</code>.
        <dt><i>Alphabetic</i>
        <dd>Equivalent to <code>/[\p{L}\p{Nl}\p{Other Alphabetic}]/</code>.
        <dt><i>Lowercase</i>
        <dd>Equivalent to <code>/[\p{Ll}\p{Other Lowercase}]/</code>.
        <dt><i>Uppercase</i>
        <dd>Equivalent to <code>/[\p{Lu}\p{Other Uppercase}]/</code>.
        <dt><i>Cased</i>
        <dd>Equivalent to <code>/[\p{Lowercase}\p{Uppercase}\p{Lt}]/</code>.
        <dt><i>Case Ignorable</i>
        <dd>Characters with a <i>Word Break</i> category of
        <i>MidLetter</i> or <i>MidNumLet</i>, or general category of
        <i>Mn</i>, <i>Me</i>, <i>Cf</i>, <i>Lm</i>, or <i>Sk</i>.
        <dt><i>Changes when Lowercased</i>
        <dd>Those whose normalized forms are not stable under a
        <code>toLowercase</code> mapping.
        <dt><i>Changes when Uppercased</i>
        <dd>Those whose normalized forms are not stable under a
        <code>toLowercase</code> mapping.
        <dt><i>Changes when Titlecased</i>
        <dd>Those whose normalized forms are not stable under a
        <code>toTitlecase</code> mapping.
        <dt><i>Changes when Casefolded</i>
        <dd>Those whose normalized forms are not stable under case folding.
        <dt><i>Changes when Casemapped</i>
        <dd>Those whose normalized forms are not stable under case mapping.
        <dt><i>ID Start</i>
        <dd>Those which start an identifier. Equivalent to the union of
        <code>\p{L}</code>, <code>\p{Nl}</code>, <code>\p{Other ID
          Start}</code>, <code>\P{Pattern Syntax}</code>, <code>\P{Pattern
          White Space}</code>.
        <dt><i>ID Continue</i>
        <dd>Those that can continue an identifier. Equivalent to the union of
        <code>\p{ID Start}</code>, <code>\p{Mn}</code>, <code>\p{Mc}</code>,
        <code>\p{Nd}</code>, <code>\p{Pc}</code>, <code>\p{Other ID
          Continue}</code>, <code>\P{Pattern Syntax}</code>, <code>\P{Pattern
          White Space}</code>
        <dt><i>XID Start</i>
        <dd><i>ID Start</i> modified for closure under NFKx.
        <dt><i>XID Continue</i>
        <dd><i>ID Continue</i> modified for closure under NFKx.
        <dt><i>Default Ignorable Code Point</i>
        <dd>Equivalent to the union of <code>\p{Other Default
          Ignorable Code Point}</code>, <code>\p{Cf}</code>,
        <code>\p{Variation Selector}</code>, <code>\P{White Space}</code>,
        <code>[^\uFFF9-\uFFFB]</code>, <code>[^\u0600-\u0603]</code>, and 
        <code>[^\u06DD\u070F]</code>.
        <dt><i>Grapheme Extend</i>
        <dd>Equivalent to the union of <code>\p{Me}</code>,
        <code>\p{Mn}</code>, and <code>\p{Other Grapheme Extend}</code>.
        <dt><i>Grapheme Base</i>
        <dd>Equivalent to the union of <code>\p{Any}</code>, <code>\P{C}</code>,
        <code>\P{Zl}</code>, <code>\P{Zp}</code>, and <code>\P{Grapheme
          Extend}</code>.
        <dt><i>Grapheme Link</i>
        <dd>Those with a canonical combining class of <i>Virama</i>.
      </dl>
    </section>

    <section>
      <h1 id=script>Script</h1>
      
      <p>If the property name is a Unicode script value, or an alias thereof,
      it represents characters in that script. In the list below, names
      separated by a solidus are equivalent.

      <ul>
        <li><i>Arab</i> / <i>Arabic</i>
        <li><i>Armi</i> / <i>Imperial Aramaic</i>
        <li><i>Armn</i> / <i>Armenian</i>
        <li><i>Avst</i> / <i>Avestan</i>
        <li><i>Bali</i> / <i>Balinese</i>
        <li><i>Bamu</i> / <i>Bamum</i>
        <li><i>Beng</i> / <i>Bengali</i>
        <li><i>Bopo</i> / <i>Bopomofo</i>
        <li><i>Brai</i> / <i>Braille</i>
        <li><i>Bugi</i> / <i>Buginese</i>
        <li><i>Buhd</i> / <i>Buhid</i>
        <li><i>Cans</i> / <i>Canadian Aboriginal</i>
        <li><i>Cari</i> / <i>Carian</i>
        <li><i>Cham</i>
        <li><i>Cher</i> / <i>Cherokee</i>
        <li><i>Copt</i> / <i>Coptic</i> / <i>Qaac</i>
        <li><i>Cprt</i> / <i>Cypriot</i>
        <li><i>Cyrl</i> / <i>Cyrillic</i>
        <li><i>Deva</i> / <i>Devanagari</i>
        <li><i>Dsrt</i> / <i>Deseret</i>
        <li><i>Egyp</i> / <i>Egyptian Hieroglyphs</i>
        <li><i>Ethi</i> / <i>Ethiopic</i>
        <li><i>Geor</i> / <i>Georgian</i>
        <li><i>Glag</i> / <i>Glagolitic</i>
        <li><i>Goth</i> / <i>Gothic</i>
        <li><i>Grek</i> / <i>Greek</i>
        <li><i>Gujr</i> / <i>Gujarati</i>
        <li><i>Guru</i> / <i>Gurmukhi</i>
        <li><i>Hang</i> / <i>Hangul</i>
        <li><i>Hani</i> / <i>Han</i>
        <li><i>Hano</i> / <i>Hanunoo</i>
        <li><i>Hebr</i> / <i>Hebrew</i>
        <li><i>Hira</i> / <i>Hiragana</i>
        <li><i>Hrkt</i>: <i>Katakana</i> or <i>Hiragana</i>
        <li><i>Ital</i> / <i>Old Italic</i>
        <li><i>Java</i> / <i>Javanese</i>
        <li><i>Kali</i> / <i>Kayah Li</i>
        <li><i>Kana</i> / <i>Katakana</i>
        <li><i>Khar</i> / <i>Kharoshthi</i>
        <li><i>Khmr</i> / <i>Khmer</i>
        <li><i>Knda</i> / <i>Kannada</i>
        <li><i>Kthi</i> / <i>Kaithi</i>
        <li><i>Lana</i> / <i>Tai Tham</i>
        <li><i>Laoo</i> / <i>Lao</i>
        <li><i>Latn</i> / <i>Latin</i>
        <li><i>Lepc</i> / <i>Lepcha</i>
        <li><i>Limb</i> / <i>Limbu</i>
        <li><i>Linb</i> / <i>Linear B</i>
        <li><i>Lisu</i> / <i>Lisu</i>
        <li><i>Lyci</i> / <i>Lycian</i>
        <li><i>Lydi</i> / <i>Lydian</i>
        <li><i>Mlym</i> / <i>Malayalam</i>
        <li><i>Mong</i> / <i>Mongolian</i>
        <li><i>Mtei</i> / <i>Meetei Mayek</i>
        <li><i>Mymr</i> / <i>Myanmar</i>
        <li><i>Nkoo</i> / <i>Nko</i>
        <li><i>Ogam</i> / <i>Ogham</i>
        <li><i>Olck</i> / <i>Ol Chiki</i>
        <li><i>Orkh</i> / <i>Old Turkic</i>
        <li><i>Orya</i> / <i>Oriya</i>
        <li><i>Osma</i> / <i>Osmanya</i>
        <li><i>Phag</i> / <i>Phags Pa</i>
        <li><i>Phli</i> / <i>Inscriptional Pahlavi</i>
        <li><i>Phnx</i> / <i>Phoenician</i>
        <li><i>Prti</i> / <i>Inscriptional Parthian</i>
        <li><i>Rjng</i> / <i>Rejang</i>
        <li><i>Runr</i> / <i>Runic</i>
        <li><i>Samr</i> / <i>Samaritan</i>
        <li><i>Sarb</i> / <i>Old South Arabian</i>
        <li><i>Saur</i> / <i>Saurashtra</i>
        <li><i>Shaw</i> / <i>Shavian</i>
        <li><i>Sinh</i> / <i>Sinhala</i>
        <li><i>Sund</i> / <i>Sundanese</i>
        <li><i>Sylo</i> / <i>Syloti Nagri</i>
        <li><i>Syrc</i> / <i>Syriac</i>
        <li><i>Tagb</i> / <i>Tagbanwa</i>
        <li><i>Tale</i> / <i>Tai Le</i>
        <li><i>Talu</i> / <i>New Tai Lue</i>
        <li><i>Taml</i> / <i>Tamil</i>
        <li><i>Tavt</i> / <i>Tai Viet</i>
        <li><i>Telu</i> / <i>Telugu</i>
        <li><i>Tfng</i> / <i>Tifinagh</i>
        <li><i>Tglg</i> / <i>Tagalog</i>
        <li><i>Thaa</i> / <i>Thaana</i>
        <li><i>Thai</i>
        <li><i>Tibt</i> / <i>Tibetan</i>
        <li><i>Ugar</i> / <i>Ugaritic</i>
        <li><i>Vaii</i> / <i>Vai</i>
        <li><i>Xpeo</i> / <i>Old Persian</i>
        <li><i>Xsux</i> / <i>Cuneiform</i>
        <li><i>Yiii</i> / <i>Yi</i>
        <li><i>Zinh</i> / <i>Inherited</i> / <i>Qaai</i>
        <li><i>Zyyy</i> / <i>Common</i>
        <li><i>Zzzz</i> / <i>Unknown</i>
      </ul>
    </section>
  </section>
</article>
