<!DOCTYPE html>
<!-- vim: set fdm=indent tw=78: --> 
<title>Tokens - Read Ruby</title>
<meta charset=utf-8>
<link href=/style rel=stylesheet>
<link rel=license href=//creativecommons.org/licenses/by-nc-sa/2.0/uk/>
<link rel=next href=/expressions>
<link rel='index up' href=/toc>

<section>  
  <h1 id=tokens>Tokens</h1>

  <p><dfn>Tokens</dfn> are <q>the mark or series of marks that denote one
    symbol or word in the language</q> (<a
    href=/references#refFISCHER92>Fischer &amp; Grodzinsky</a>, pp.
  59–62). A Ruby program consists of a combination of the following
  tokens:</p>

  <aside class=sidenote>
    <code>Ripper</code> is a class in the standard library for parsing and
    analysing Ruby. The <code>Ripper.tokenize</code> method takes a string
    of code as an argument and returns an array of its constituent tokens.
    Experiment with this method in <abbr title="Interactive
      Ruby">IRB</abbr> (<code>irb -rripper</code>) to test your
    assumptions of how tokenization works.
  </aside>

  <ul>
    <li><a href=#comments>Comments</a>
    <li><a href=/objects#literals>Literals</a>
    <li>Punctuation
    <li><a href=#identifiers>Identifiers</a>
    <li><a href=#keywords>Keywords</a>
  </ul>


  <section>
    <h1 id=comments>Comments</h1>

    <p><dfn>Comments</dfn> are remarks which do not affect the meaning of a
    program. They are introduced with a number sign (<code class=u
      title='#'>U＋0023</code>) and continue until the end of the line: the
    text between <code>#</code> and the end of the line is ignored by the
    interpreter. Comments are not recognised inside of <a
      href=/objects#strings>string</a>/<a href=/objects#regexps>regexp</a>
    literals—they are interpreted literally—however, regexps support an
    alternative form of embedded comment. There is no specific construct for
    multiline comments, but they may be approximated with <a
      href=#embedded-doc>embedded documentation</a>.
  </section>

  <!-- Token? -->
  <section>
    <h1 id=embedded-doc>Embedded Documentation</h1>

    <p><dfn>Embedded documentation</dfn> is a portion of a source file that
    contains documentation intended for a postprocessor such as
    <code>rdoc</code>, and as such is ignored by the interpreter. It is
    introduced by a line beginning <code>=begin</code>, that is an equals
    sign (<code class=u title='='>U＋003D</code>) followed by the string
    <code>begin</code>, and continue until a line beginning
    <code>=end</code> is encountered.

    <p>Both <code>=begin</code> and <code>=end</code> may be followed by
    arbitrary text, which is included in the embedded documentation, as long
    as it is preceded by a whitespace character. Conventionally, the text
    following <code>=begin </code> names the tool for which the
    documentation is intended.
  </section>

  <section>
    <h1 id=whitespace>Whitespace</h1>

    <p><dfn>Whitespace</dfn> consists only of <code
      class=u>U＋0009</code>–<code class=u>U＋000D</span> and the space
    character (<code class=u title=' '>U＋0020):</p>

    <ul>
      <li><code class=u>U＋0009</code> (horizontal tab)
      <li><code class=u>U＋000A</code> (line feed)
      <li><code class=u>U＋000B</code> (vertical tab)
      <li><code class=u>U＋000C</code> (form feed)
      <li><code class=u>U＋000D</code> (carriage return)
      <li>〈<code class=u>U＋000D</code>,&nbsp;<code class=u>U＋000A</code>〉
      (carriage return followed by line feed)
      <li><code class=u title=' '>U＋0020</code> (space)
    </ul>

    <p>The primary role of whitespace in Ruby syntax is to separate tokens
    and terminate statements. When whitespace is syntactically significant
    it is typically collapsed to a single space. The few areas of syntax
    where whitespace has different semantics are clearly labeled. Newlines
    are used as <a href=#statement-terminators>statement terminators</a>.
  </section>

  <section>
    <h1 id=punctuation>Punctuation</h1>

    <!-- Note that, unless stated otherwise, this doesn't apply to string
    or regexp literals. Include regexp symbols? -->

    <section>
      <h1 id=ampersands>Ampersands</h1>
      
      <p>An ampersand (<code class=u title='&'>U＋0026</code>) in the
      context of…

      <dl>
        <dt>A message expression
        <dd>Converts a <code>Proc</code> object to a block, passing it to
        the receiver.
        <dt>A parameter list
        <dd>Signifies that the identifier that follows corresponds to the
        block sent along with the message.
        <dt>An operator
        <dd>Performs bitwise AND. The operator consisting of two consecutive
        ampersands performs Boolean AND. 
      </dl>
    </section>

    <section>
      <h1 id=apostrophes>Apostrophes</h1>
      
      <p>An apostrophe (<code class=u title="'">U＋0027</code>) delimits <a
        href=#single-quoted-strings>single-quoted strings</a>.
    </section>

    <section>
      <h1 id=asterisks>Asterisks</h1>

      <p>An asterisk (<code class=u title='*'>U＋002A</code>) in the
      context of…

      <dl>
        <dt>A message expression
        <dd>Explodes an object into its constituent elements.
        <dt>A parameter list
        <dd>Prefixes a parameter which may receive a variable number of
        arguments,
        <dt>An operator
        <dd>Performs multiplication—when alone—or exponentiation—when
        preceded by another asterisk.
      </dl>
    </section>

    <section>
      <h1 id=cicumflex-accents>Circumflex Accents</h1>

      <p>The circumflex accent (<code class=u title='^'>U＋005E</code>) is an
      binary operator that performs bitwise exclusive or.
    </section>
    
    <section>
      <h1 id=colons>Colons</h1>

      <p>A colon (<code class=u title=':'>U＋003A</code>) in the context of…

      <dl>
        <dt>A symbol literal
        <dd>Creates a symbol from the following identifier or string.
        <dt>A hash literal
        <dd>Separates symbol keys from their corresponding values.
        <dt>Ternary conditional
        <dd>Separates the <i>if</i> clause from the <i>else</i> clause.
        <dt>A constant reference
        <dd>Two consecutive colons serve as the scope operator, separating the
        names of nested constants.
      </dl>
    </section>
    
    <section>
      <h1 id=commas>Commas</h1>
      
      <p>A comma (<code class=u title=','>U＋002C</code>) separates
      expressions in a list. It is used in message expressions, parameter
      lists, assignment expressions, and array literals.
    </section>

    <section>
      <h1 id=commercial-ats>Commercial At Signs</h1>
      
      <p>When the commercial at sign (<code class=u title='@'>U＋0040</code>)
      prefixes an identifier it is a sigil introducing an instance variable—if
      it appears by itself—or a class variable—if it is preceded by another.
      In a symbol literal or method name, an <code>@</code> suffix
      distinguishes a unary operator from a binary operator with the same
      name. 
    </section>

    <section>
      <h1 id=curly-brackets>Curly Brackets</h1>
      
      <p>A pair of curly brackets (<code class=u title='{'>U＋007B</code>,
      <code class=u title='}'>U＋007D</code>) in the context of a message
      expression delimit a block which is sent along with the message,
      otherwise they delimit a hash literal.
    </section>

    <section>
      <h1 id=dollar-signs>Dollar Signs</h1>

      <p>A dollar sign (<code class=u title='$'>U＋0024</code>) followed by an
      identifier is a sigil denoting a global variable.
    </section>

    <section>
      <h1 id=equals-signs>Equals Signs</h1>

      <p>An equals sign (<code class=u title='='>U＋003D</code>) in the
      context of…

      <dl>
        <dt>An assignment expression
        <dd>Separates the variables being assigned to from the values being
        assigned to them.
        <dt>An operator
        <dd>Tests for equality if doubled, case equality if tripled, and
        inequality if prefixed and/or suffixed with less‐than  (<code class=u
          title='<'>U＋003C</code>) or greater‐than (<code class=u
          title='>'>U＋003E</code>) signs; performs pattern matching if
        followed by a tilde (<code class=u title='~'>U＋007E</code>).
        <dt>A parameter list
        <dd>Signifies that a parameter is optional and its default value
        <dt>Hash literals (=&gt;)
        <dd>When followed by a greater‐than sign (<code class=u
          title='>'>U＋003E</code>) separates a key from its value.
        <dt>Embedded documentation
        <dd>Introduces the beginning of embedded documentation when appearing
        at the start of a line followed by <code>begin</code>, and the end
        when appearing at the start of a line followed by <code>end</code>
      </dl>
    </section>

    <section>
      <h1 id=exclamation-marks>Exclamation Marks</h1>

      <p>An exclamation mark (<code class=u title='!'>U＋0021</code>) in the
      context of…

      <dl>
        <dt>A selector
        <dd>Signifies the message deserves extra attention 
        <dt>An operator
        <dd>Negates its operand, when used as a unary operator, the sense of a
        pattern match, when followed by a tilde (<code class=u
          title='~'>U＋007E</code>), or a test for equality, when followed by
        an equals sign (<code class=u title='='>U＋003D</code>). 
      </dl>
    </section>

    <section>
      <h1 id=full-stops>Full Stops</h1>

      <dl>
        <dt>Message expressions
        <dt>Range literals
        <dt>Float literals
        <dt>Flip-flop operator
      </dl>
    </section>

    <section>
      <h1 id=grave-accents>Grave Accents</h1>
      
      <p>Backticks, Kernel method
    </section>

    <section>
      <h1 id=greater-than>Greater‐Than Signs</h1>

      <dl>
        <dt>Operators
        <dt>Hash literals (=&gt;)
      </dl>
    </section>

    <section>
      <h1 id=hyphen-minus>Hyphen Minus Signs</h1>

      <dl>
        <dt>Operators
        <dt>Lambda literals
      </dl>
    </section>

    <section>
      <h1 id=less-than>Less‐Than Signs</h1>

      <dl>
        <dt>Operators
        <dt>Class definition
        <dt>Eigenclass definition
      </dl>
    </section>

    <section>
      <h1 id=low-lines>Low Lines</h1>

      <dl>
        <dt>Local variables
        <dt>Indicates language keywords: __FILE__, __method__, __send__.
        <dt>Numeric literals
      </dl>
    </section>

    <section>
      <h1 id=newlines>Newlines</h1>
      
      <dl>
        <dt>Statement terminator
        <dt>if, else, etc. separator
      </dl>
    </section>

    <section>
      <h1 id=number-signs>Number Signs</h1>

      <dl>
        <dt>Comments
        <dt>String interpolation
      </dl>
    </section>

    <section>
      <h1 id=parentheses>Parentheses</h1>

      <dl>
        <dt>Message expressions
        <dt>Grouping
        <dt>Method definitions
      </dl>
    </section>

    <section>
      <h1 id=percent-signs>Percent Signs</h1>

      <dl>
        <dt>Operators
        <dt>Alternative delimiters
      </dl>
    </section>

    <section>
      <h1 id=plus-signs>Plus Signs</h1>

      <p>Operators
    </section>

    <section>
      <h1 id=question-marks>Question Marks</h1>

      <dl>
        <dt>Selectors
        <dt>Ternary expressions
      </dl>
    </section>

    <section>
      <h1 id=quotation-marks>Quotation Marks</h1>

      <p>Double-quoted string literals
    </section>

    <section>
      <h1 id=reverse-solidi>Reverse Solidi</h1>

      <p>Character escapes
    </section>

    <section>
      <h1 id=semicolons>Semicolons</h1>

      <p>Statement terminators
    </section>

    <section>
      <h1 id=solidi>Solidi</h1>
      
      <dl>
        <dt>Regexp literals
        <dt>Operator
      </dl>
    </section>

    <section>
      <h1 id=square-brackets>Square Brackets</h1>

      <dl>
        <dt>Array literals
        <dt>Selector
      </dl>
    </section>

    <section>
      <h1 id=tildes>Tildes</h1>
      
      <p>Operators
    </section>

    <section>
      <h1 id=vertical-lines>Vertical Lines</h1>

      <dl>
        <dt>Selector
        <dt>Operators
        <dt>Block parameters
      </dl>
    </section>
  </section>

  <section>
    <h1 id=identifiers>Identifiers</h1>
    
    <p>An <dfn>identifier</dfn> is the name of a variable or constant. It
    must not contain any US-ASCII character other than the alphanumerics
    (A—Z, a—z, 0–9) and the low line (<code class=u
      title='_'>U＋005F</code>), or begin with a US-ASCII digit. However, it
    may contain any other character legal in the source encoding.</p>
  </section>

  <section>
    <h1 id=literals>Literals</h1>
      
    <!-- Discuss &:sym as a literal? -->
    <p>An <dfn title=literal>object literal</dfn> is a syntactical shortcut
    for the instantiation of a particular core object.</p> <!-- Doesn’t call
    initialize; Performance pips pedagogy --> <!-- Cover block literals? -->

    <section>
      <h1 id=strings>Strings</h1>
       
      <p><code>String</code>s are mutable sequences of characters with
      an associated encoding.</p>

      <section>
        <h1 id=character>Character</h1>
      
        <figure class=railroad>
          <img id=character-literal.png>
          <figcaption>Syntax diagram of the character literal
        </figure>

        <p>A single character prefixed with a question mark
        (<code>?<var>char</var></code>) instantiates a <code>String</code>
        comprising the character.
      </section>
      
      <!-- TODO: alternative delimiters-->

      <section>
        <h1 id=single-quoted-strings>Single-Quoted Strings</h1>
        
        <figure class=railroad>
          <img id=single-quoted-string-literal.png>
          <figcaption>Syntax diagram of the single-quoted string literal
        </figure>
        
        <p>A single-quoted <code>String</code> is a string delimited by
        apostrophe (<code class=u title="'">U＋0027</code>) characters or
        <a href=#single-quoted-strings-q><code>%q</code></a>. Its contents
        are not subject to <a
          href=#string-interpolation>interpolation</a>. The only
        recognised <a href=#string-escapes>escape sequences</a> are
        <code>\\</code> and <code>\<var>delimiter</var></code>; any other
        escape is interpreted literally, i.e. as a reverse solidus
        followed by a single character.</p>
         
        <section>
          <h1 id=single-quoted-strings-q>Alternative Delimiters</h1>
          
          <figure class=railroad>
            <img id=single-quoted-string-literal-q.png>
            <figcaption>Syntax diagram of the <code>%q</code>
            single-quoted string literal
          </figure>
          
          <p>A single-quoted string may also be delimited by arbitrary
          delimiters with the
          <code>%q<var>delimiter</var>…<var>delimiter</var></code> construct,
          where <var>delimiter</var> is a single character.  If
          <var>delimiter</var> appears in the string it must be escaped.
          
          <p>If the opening delimiter is <code>(</code>, <code>[</code>,
          <code>&lt;</code>, or <code>{</code>, the closing delimiter must be
          the corresponding closing bracket. For example, if the opening
          delimiter is <code>[</code>, the closing delimiter must be
          <code>]</code>. When these paired delimiters are used, the same pair
          may appear inside the string as long as they are properly
          balanced.</p>
           
          <figure id=single-quoted-string-literal-q.rb>
            <figcaption>Constructing a single-quoted string with alternative
            delimiters using <code>%q</code>
          </figure>
        </section>
      </section>
      
      <section>
        <h1 id=double-quoted-strings>Double-Quoted Strings</h1>
        
        <figure class=railroad>
          <img id=double-quoted-string-literal.png>
          <figcaption>Syntax diagram of the double-quoted string literal
        </figure>
        
        <p>A double-quoted <code>String</code> is a <code>String</code>
        delimited with quotation marks (<code class=u
          title='"'>U＋0022</code>) characters or <a
          href=#double-quoted-strings-q><code>%Q</code></a>. Its contents
        are subject to <a href=#string-interpolation>interpolation</a> and
        <a href=#string-escapes>character escapes</a>.</p>
        
        <section>
          <h1 id=string-interpolation>String Interpolation</h1>
          
          <figure class=railroad>
            <img id=string-interpolation.png>
            <figcaption>Syntax diagram of the string interpolation
            construct
          </figure>
          
          <p><dfn title="string interpolation">Interpolation</dfn> is
          the embedding of the value of an expression within a string.
          The general form of the syntax is
          <code>#{<var>expression</var>}</code>.  It is common for
          <var>expression</var> to be simply the name of a local
          variable which is to be substituted for its value.
          
          <p>The braces can be omitted if <var>expression</var> is the
          name of a global—, class—, or instance variable. However, in
          this case the variable name cannot be immediately followed by
          a character legal in an identifier, as ambiguity results. </p>
        </section>

        <section>
          <h1 id=string-escapes>String Escapes</h1>
           
          <figure class=railroad>
            <img id=escape.png>
            <figcaption>Syntax diagram of the string escape
          </figure>
           
          <p><dfn title="backslash escape">Escape sequences</dfn> are
          character sequences prefixed with a reverse solidus (<code
            class=u title='\'>U＋005C</code>) that have a meaning other
          than their constituent characters.</p>
           
          <section>
            <h1 id=character-escapes>Character Escapes</h1>

            <figure class=railroad>
              <img id=character-escape.png>
              <figcaption>Syntax diagram of the string escape
            </figure>

            <p>A character escape consists of a reverse solidus followed
            by a single character, <var>char</var>. If <var>char</var> is
            one of [<code>abcefnrstuvxCM01234567</code>], the escape has
            the meaning given in the table below. If <var>char</var> is a
            literal <a href=/programs#newlines>line terminator</a>, both
            the reverse solidus and the line terminator are removed from
            the string. In all other cases <code>\<var>char</var></code>
            evaluates to <var>char</var>.</p>

            <figure id=character-escape.rb>
              <figcaption>A character escape is a reverse solidus followed by
              a single character
            </figure>
          </section>

          <section>
            <h1 id=byte-escapes>Byte Escapes</h1>

            <figure class=railroad>
              <!-- TODO: Incorporate maximumn value of octal integer: 377
              -->
              <img id=byte-escape.png>
              <figcaption>Syntax diagram of the byte escape
            </figure>

            <section>
              <h1 id=octal-byte>Octal Byte Escapes</h1>

              <p>A reverse solidus followed by an octal number between zero
              and 377<sub>8</sub> represents the character whose character
              code that is.</p>

              <figure id=octal-byte-escape.rb>
                <figcaption>An octal byte escape consists of a backslash
                followed by a character code in base 8
              </figure>
            </section>

            <section>
              <h1 id=hex-byte>Hexadecimal Byte Escapes</h1>

              <p>A hexadecimal byte escape consists of <code>\x</code>
              followed by a hexadecimal number ≤ FF<sub>16</sub>. It
              represents the character whose code is given by the number.</p>

              <figure id=hex-byte-escape.rb>
                <figcaption>A hexadecimal byte escape consists of a backslash
                followed by an <code>x</code> followed by one or two
                hexadecimal digits
              </figure>
            </section>
          </section>

          <section>
            <h1 id=control-escapes>Control Escapes</h1>

            <figure class=railroad>
              <img id=control-escape.png>
              <figcaption>Syntax diagram of the control escape
            </figure>

            <p>The escape sequence for <a
            href=//en.wikipedia.org/wiki/Control_character>control
            character</a>
            <kbd><kbd>Ctrl</kbd>-<kbd><var>char</var></kbd></kbd> consists of
            a reverse solidus, either <code>c</code> or <code>C-</code>, then
            <var>char</var>, which may be a character or escape.
            (<var>char</var> must not be a <a
            href=#control-escape>control</a>, Unicode, <a
            href=#hex-byte>hexadecimal</a>, or three-digit <a
            href=#octal-byte>octal</a>, escape). Its value is the character
            whose character code is that of <var>char</var> ∧ 0x9F.</p>
            
            <figure id=control-escape.rb>
              <figcaption>The control escape represents a control key
            </figure>
          </section>

          <section>
            <h1 id=meta-escapes>Meta Character Escapes</h1>

            <figure class=railroad>
              <img id=meta-escape.png>
              <figcaption>Syntax diagram of the meta character escape
            </figure>

            <p>The meta character escape <code>\M-<var>char</var></code>
            represents the character whose character code is that of
            <var>char</var> ∨ 0x80, where <var>char</var> is a single
            character or escape. (<var>char</var> must not be a <a
            href=#meta-escape>meta character</a>, Unicode, <a
            href=#hex-byte>hexadecimal</a>, or three-digit <a
            href=#octal-byte>octal</a>, escape).</p>

            <figure id=meta-escape.rb>
              <figcaption>The meta character escape represents the given meta
              character.
            </figure>
          </section>

          <section>
            <h1 id=unicode-escapes>Unicode Escapes</h1>
               
            <figure class=railroad>
              <img id=unicode-escape.png>
              <figcaption>Syntax diagram of the Unicode <code>\u</code>
              escape
            </figure>
            
            <p>An arbitrary <a
            href=//en.wikipedia.org/wiki/Unicode>Unicode</a> character may be
            embedded in a string by specifying its <a
            href=//en.wikipedia.org/wiki/Codepoint>codepoint</a> as four
            hexadecimal digits following <code>\u</code>.            

            <p>The <code>\u{}</code> construct extends this ability to
            embedding multiple codepoints with the same escape.
            The curly braces delimit one or more hexadecimal codepoints
            separated by whitespace. This form does not restrict a
            codepoint to four digits.</p>             

            <figure class=railroad>
              <img id=hex-codepoint.png>
              <figcaption>Syntax diagram of a Unicode codepoint in hexadecimal
            </figure>

            <p>Both escapes above force the string in which they are
            embedded to have UTF-8 encoding. However, they are illegal
            in a file that has both a non-UTF-8 source encoding and
            a string containing literal multibyte characters in that
            encoding.</p>

            <figure id=unicode-escape.rb>
              <figcaption>A Unicode escape represents a Unicode character with
              the given codepoint(s)
            </figure>
          </section>

          <table class=border>
            <thead>
              <tr><th>Escape Sequence<th>Interpretation
            </thead>
            <tbody>
              <tr class=odd>
                <td><code>\a</code>
                  <td><code class=u>U＋0007</code>: The <a
                    href=//en.wikipedia.org/wiki/Bell_character>BEL</a>
                    character. Rings the console bell.
              <tr>
                <td><code>\b</code>
                <td><code class=u>U＋0008</code>: The <a
                    href=//en.wikipedia.org/wiki/Backspace>Backspace</a>
                  character.
              <tr class=odd>
                <td><code>\e</code>
                <td><code class=u>U＋001B</code>: The <a
                    href=//en.wikipedia.org/wiki/Esc>ESC</a> character.
              <tr>
                <td><code>\f</code>
                <td><code class=u>U＋000C</code>: The <a
                    href=//en.wikipedia.org/wiki/Form_feed>Form Feed</a>
                  character.
              <tr class=odd>
                <td><code>\n</code>
                <td><code class=u>U＋000A</code>: The <a
                    href=//en.wikipedia.org/wiki/Newline>Newline</a>
                  character.
              <tr>
                <td><code>\r</code>
                <td><code class=u>U＋000D</code>: The <a
                    href=//en.wikipedia.org/wiki/Carriage_return>Carriage
                    Return</a> character.
              <tr class=odd>
                <td><code>\s</code>
                <td><code class=u title=' '>U＋0020</code>: The <a
                    href=//en.wikipedia.org/wiki/Space_key>Space</a>
                  character.
              <tr>
                <td><code>\t</code>
                <td><code class=u>U＋0009</code>: The <a
                    href=//en.wikipedia.org/wiki/Tab_character>Tab</a>
                  character
              <tr class=odd>
                <td><a
                href=#unicode-escapes><code>\u<var>hex</var><var>hex</var><var>hex</var><var>hex</var></code></a>
                  <td>The Unicode codepoint specified by the four given
                  hexadecimal digits.
              <tr>
                <td><a
                href=#unicode-escapes><code>\u{<var>codepoints</var>}</code></a>
                <td>The Unicode codepoint(s) specified by
                  <a href=#unicode-escapes><var>codepoints</var></a>.
              <tr class=odd>
                <td><code>\v</code>
                <td><code class=u>U＋000B</code>: The vertical tab
                  character.
              <tr>
                <td><a
                href=#octal-byte><code>\<var>octal</var><var>octal</var><var>octal</var></code></a>
                <td>The byte specified by the three given octal digits,
                  whose combined value does not exceed 377<sub>8</sub>.
              <tr class=odd>
                <td><a
                href=#octal-byte><code>\<var>octal</var><var>octal</var></code></a>
                <td>The byte specified by the two given octal digits.
              <tr>
                <td><a href=#octal-byte><code>\<var>octal</var></code></a>
                <td>The byte specified by the given octal digit.
              <tr class=odd>
                <td><a
                href=#hex-byte><code>\x<var>hex</var><var>hex</var></code></a>
                <td>The byte specified by the two given hexadecimal
                  digits.
              <tr>
                <td><a href=#hex-byte><code>\x<var>hex</var></code></a>
                <td>The byte specified by the given hexadecimal digit.
              <tr class=odd>
                <td><a
                href=#control-escapes><code>\c<var>char</var></code></a>
                <td rowspan=2>The control character
                <kbd><kbd>Ctrl</kbd>-<kbd><var>char</var></kbd></kbd>.
              <tr class=odd>
                <td><a
                href=#control-escapes><code>\C-<var>char</var></code></a>
              <tr>
                <td><a href=#meta-escapes><code>\M-<var>char</var></code></a>
                <td>Meta character <var>char</var>.
              <tr class=odd>
                <td><code>\</code><code class=u>U＋000A</code>
                <td rowspan=3>A backslash before a <a
                    href=//en.wikipedia.org/wiki/Newline>line terminator</a>
                  escapes it, removing both the line
                  terminator and backslash from the string
              <tr class=odd>
                <td><code>\</code><code class=u>U＋000D</code>
              <tr class=odd>
                <td><code>\</code>〈<code class=u>U＋000D</code>,&nbsp;<code
                    class=u>U＋000A</code>〉
              <tr>
                <td><code>\<var>char</var></code>
                <td>A backslash before any other character evaluates to
                  the character itself
            </tbody>
          </table>
        </section>

        <section>
          <h1 id=double-quoted-strings-q>Alternative Delimiters</h1>
          
          <figure class=railroad>
            <img id=double-quoted-string-literal-q.png>
            <figcaption>Syntax diagram of the <code>%Q</code>
            double-quoted string literal
          </figure>
          
          <p>A double-quoted string may also be delimited by arbitrary
          delimiters with the
          <code>%Q<var>delimiter</var>…<var>delimiter</var></code> and
          <code>%<var>delimiter</var>…<var>delimiter</var></code>constructs,
          where <var>delimiter</var> is a single character.  If
          <var>delimiter</var> appears in the string it must be escaped.
           
          <p>If the opening delimiter is <code>(</code>, <code>[</code>,
          <code>&lt;</code>, or <code>{</code>, the closing delimiter
          must be the corresponding closing bracket. For example, if the
          opening delimiter is <code>[</code>, the closing delimiter
          must be <code>]</code>. When these paired delimiters are used,
          the same pair may appear inside the string as long as they are
          properly balanced.</p>
            
          <figure id=double-quoted-string-literal-q.rb>
            <figcaption>Constructing a double-quoted string with
            alternative delimiters using <code>%Q</code>
          </figure>
        </section>
      </section>
      
      <p>Therefore, a <dfn>string literal</dfn> is either a double-quoted
      string literal or a single-quoted string literal.</p>
      
      <figure class=railroad>
        <img id=string-literal.png>
        <figcaption>Syntax diagram of the string literal
      </figure>
       
      <section>
        <h1 id=here-documents>Here Documents</h1>
        
        <figure class=railroad>
          <img id=here-doc.png>
          <figcaption>Syntax diagram of the here document
        </figure>
         
        <p><dfn>Here documents</dfn> extend the concept of alternative
        delimiters to allow an arbitrary <em>sequence</em> of characters
        as a delimiter. They begin with <code>&lt;&lt;</code> followed
        immediately by an arbitary identifier or string literal. Their
        content begins on the following line and continues until that
        same identifier/string is seen on a line by itself with no
        intervening whitespace. If there is a hyphen between the
        opening <code>&lt;&lt;</code> and the delimiter, i.e.
        <code>&lt;&lt;-<var>delimiter</var></code>, the closing
        delimiter may be preceded with whitespace. The final newline
        character before the closing delimiter is part of the here
        document’s contents: a minimal here document is equivalent to
        <code>"\n"</code>.
        
        <p>If the delimiter is an identifier or double quoted string,
        the contents of the here document is interpreted with
        double-quoted string semantics. Otherwise, the here document’s
        contents are interpreted literally: all escape sequences and
        interpolation constructs are ignored.</p>
        
        <figure id=here-doc.rb>
          <figcaption>Using a here document to render a poem
        </figure>
      </section>

      <section>
        <h1 id=backticks>Backticks</h1>
          
        <p>A double-quoted string delimited with grave accents (<code
          class=u title='`'>U＋0060</code>) characters, or “backticks”,
        executes its contents as an operating system command and returns
        the output. This is achieved by the <code>Kernel.`</code> method,
        which can be redefined to alter these semantics. Alternative
        delimiters can be used with the corresponding
        <code>%x<var>delimiter</var>…<var>delimiter</var></code>
        construct, which follows the same rules as <a
          href=#double-quoted-strings-q><code>%Q</code></a>.</p>
        
        <figure id=backticks.rb>
          <figcaption>Using backticks to execute commands and retrieve
          the output
        </figure>
      </section>

      <!-- TODO: Snip below paragraph? -->
      <p>A string may be iterated over by Unicode codepoint with
      <code>String#codepoints</code>, byte with <code>String#bytes</code>,
      character with <code>String#chars</code>, or line with
      <code>String#lines</code>.</p>
    </section>
      
    <section>
      <h1 id=symbols>Symbols</h1>

      <figure class=railroad>
        <img class=left id=operator-method-selector.png>
        <img class=left id=non-symbol-character.png>
        <img class=inline id=symbol.png>
        <!-- TODO: Exclude \0 -->
        <!-- TODO: Look for other exceptions to this rule -->
        <img class=inline id=symbol-literal.png>
        <figcaption class=clear>Syntax diagram of the symbol literal
      </figure>

      <p>A <code>Symbol</code> represents a name.
      <code>Symbol</code>s are immutable immediates. Two symbols
      with the same content will always be represented by the same
      object, e.g. <code>:glark.object_id ==
        :glark.object_id</code>, so symbol comparisons are extremely
      efficient.  However, <code>Symbol</code> objects are not
      garbage collected, so are unsuitable for storing data from
      unbounded collections; use <code>String</code>s instead.
      
      <p><code>Symbol</code>s are used for unique identifiers, such
      as <code>Hash</code> keys, as message selectors and method
      names, and as a substitute for constants.

      <p>A <code>Symbol</code> literal consists of a colon followed
      by an symbol or <code>String</code> literal, e.g.
      <code>:roland_barthes</code> or <code>:'887'</code>.
      The <code>%s<var>delimiter</var>…<var>delimiter</var></code>
      construct enables symbols to be specified between arbitrary
      delimiters along the same lines as <a
        href=#single-quoted-strings-q><code>%q</code></a>.

      <!-- #to_sym -->
    </section>

    <section>
      <h1 id=numerics>Numerics</h1>
      <!-- Are immediates _instantiated_? -->
                 
      <p>A decimal integer literal consists of an optional sign
      (<code>+</code> or <code>-</code>) followed by one or more decimal
      digits. Implementation limits dictate whether its a <code>Fixnum</code>
      or <code>Bignum</code>, but the distinction can be ignored by treating
      both as <code>Integer</code>s.</p>
       
      <!-- TODO: Mention optional 0d prefix -->

      <figure class=railroad>
        <div class=centre style=width:467px>
          <img style=display:inline id=digit.png>
          <img style=display:inline id=non-zero-digit.png>
          <img style=display:inline id=plus-minus.png>
        </div>
        <img id=decimal-literal.png>
        <figcaption>Syntax diagram of the decimal literal
      </figure>
       
      <p>Hexadecimal, octal, and binary literals allow integers to be
      expressed in base sixteen, eight, or two, respectively. A hexadecimal
      literal begins with <code>0x</code>, and is followed by one or more hex
      digits (0–9, a–f). An octal literal begins with <code>0o</code>, and is
      followed by one or more octal digits (0–7). A binary literal begins with
      <code>0b</code>, and is followed by one or more binary digits (0–1). All
      forms ignore case and create <code>Integer</code> objects.</p>
       
      <figure class=railroad>
        <img style=float:left id=hex-digit.png>
        <img style=float:left id=octal-digit.png>
        <img id=hexadecimal-literal.png>
        <img id=binary-literal.png>
        <img id=octal-literal.png>
        <br style=clear:both>
        <figcaption>Syntax diagrams of the hexadecimal, binary, and
        octal literals
      </figure>
       
      <p>A floating-point literal consists of two integer literals
      separated with a period, e.g. <code>3.14</code>. It is of
      class <code>Float</code>.</p>
      <!-- Notes on the inacuracy of floats -->
      
      <figure class=railroad>
        <img id=float-literal.png>
        <figcaption>Syntax diagram of the floating-point literal
      </figure>
      
      <p>A scientific notation literal consists of a coefficient
      (<var>a</var>: a decimal or <code>Float</code> literal),
      <code>e</code> or <code>E</code>, then an exponent
      (<var>e</var>: a decimal literal). Its value is
      <code><var>a</var> × 10<sup><var>e</var></sup></code>
      represented as a <code>Float</code>.</p>
      
      <figure class=railroad>
        <img id=scientific-notation-literal.png>
        <figcaption>Syntax diagram of the scientific notation literal
      </figure>
              
      <p><code>Rational</code> numbers are expressed with the
      <code>Rational(<var>numerator</var>, <var>denominator</var>)</code>
      constructor. Similarly, <code>Complex(<var>real</var>,
        <var>imaginary</var>)</code> creates a <code>Complex</code>
      object.</p>
           
      <!--        <li>Standard mathematical operations as methods
            <li><code>/</code> performs integer division
            <li>to_* 
      -->
    </section>

    <section>
      <h1 id=arrays>Arrays</h1>
       
      <!-- TODO: Determine clear way to diagram optional spaces -->
      <figure class=railroad>
        <img id=array-literal.png>
        <figcaption>Syntax diagram of the array literal
      </figure>
       
      <!-- Mention #to_a? --> <p>An <code>Array</code> instance represents an
      ordered collection of objects, which need not be homogeneous. It is
      automatically resized as elements are added or removed.</p>
      
      <figure class=railroad>
        <img id=expression-list.png>
        <figcaption>Syntax diagram of an expression list
      </figure>

      <p>An <code>Array</code> literal is a comma-separated list of
      expressions enclosed in square brackets (<code>[</code>,
      <code>]</code>). For example, <code>[1, :two, 'three']</code> creates a
      three-element <code>Array</code> object with <code>1</code> as the first
      element.</p>
        
      <section>
        <h1 id=array-literal-w>Alternative Delimiters</h1>
                  
        <p>The <code>%w<var>delimiter</var>…<var>delimiter</var></code>
        construct is a syntactical shortcut for instantiating an array
        of strings. The delimiters take the same form as those of <a
          href=#single-quoted-string-q><code>%q</code></a>. The text
        between them is split on whitespace, each substring becoming an
        element on the array. <code>%w</code> interprets its contents
        with single-quoted string semantics; its counterpart,
        <code>%W</code>, behaves in the same way using double-quoted
        string semantics.</p>
         
        <figure id=array-literal-w.rb>
          <figcaption>Creating an array of strings with the
          <code>%w</code> and <code>%W</code> constructs
        </figure>
      </section>
      
      <p>Arrays are indexed by integral subscripts, beginning with 0. If the
      subscript is negative it counts backward from the last element (i.e.
      <code>-1</code> refers to the last element).  An element with subscript
      <var>index</var> can be retrieved with
      <code>Array#[<var>index</var>]</code>. If the index doesn’t exist,
      <code>nil</code> is returned. The index can be assigned to with
      <code>Array#[<var>index</var>]=</code>. 
       
      <p>Elements are appended to an array with <code>Array#&lt;&lt;</code>;
      and prepended with <code>Array#unshift</code>.
      <code>Array#include?(<var>element</var>)</code> tests whether the array
      contains <var>element</var>. The total number of elements is returned by
      <code>Array#size</code>. <code>Array#each</code> iterates over the
      array, <code>yield</code>ing the next element each time.</p>
                
      <aside>
        <h1 id=enumerables>Enumerables</h1>
         
        <!-- Mention #to_enum? -->
        <p>Core classes such as <code>Array</code>, <code>Hash</code>, and
        <code>Range</code> mixin the <code>Enumerable</code> module. Any object
        may do the same as long as its class defines an <code>#each</code> method
        which <code>yield</code>s the next element in the collection on every
        invocation.  In return, the class gains a staggering variety of methods
        for working with collections such as the following.
                
        <p><code>#map {|<var>element</var>| }</code> returns an
        <code>Array</code> created by passing each element of the collection to
        the block, then storing the result. For example, <code>[1,2,3].map{|n|
          n**2} #=&gt; [1,4,9]</code>. <!-- Symbol#to_proc ? -->
         
        <p><code>#reduce {|<var>element<sub>0</sub></var>,
          <var>element<sub>n</sub></var>| }</code> passes the first two
        elements to the block, then for each subsequent element the last
        result of the block and the element itself. For example:
        <code>[2,3,5,7].reduce(&amp;:+) =&gt; 17</code>.
         
        <p><code>#select {|<var>element</var>| }</code> returns an
        <code>Array</code> of elements for which the block returned
        <code>true</code>.
        
        <p>Lastly, <code>#any?</code>, <code>#all?</code>, and <code>#none?</code>
        accept a block which is called with an element of the collection. The
        determinative indicates how many elements of the collection the block must
        return <code>true</code> for the method to return <code>true</code>. For
        instance, <code>#any?</code> returns <code>true</code> as soon as a single
        element in the collection satisfies the block. 
        <!-- History:
        http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/26301
        --> 
        <!-- ruby-core: 25769 (Enumerator#next in JRuby) -->
      </aside>
    </section>

    <section>
      <h1 id=hashes>Hashes</h1>
        
      <!--<code>{phileas_fog: :jean_passepartout, bertie_wooster:
          :reginald_jeeves}</code>.-->
      
      <!-- Mention Hash#[]? -->
      <p>A <code>Hash</code> instance represents a collection of associations
      between unique keys and values (<i>key-value</i> pairs), both of which may
      be any object. It is indexed by key, and ordered by insertion<sup>†</sup>. For
      instance, a <code>Hash</code> mapping colours to corresponding fruits may
      include a key-value pair of <code>:lemon =&gt; :yellow</code>:
      <code>:lemon</code> is the key; <code>:yellow</code> is the value.</p>

      <aside class=footnote>
      <p><span class=number>†</span>Hash tables do not normally <a
        href=//blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/12542>preserve
        order of insertion</a>, of course; a <a
        href=//blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-core/12556>doubly-circularly
        linked list</a> is used behind the scenes. Ilya Grigorik
        <a
          href=//www.igvita.com/2009/02/04/ruby-19-internals-ordered-hash/>examined
          the consequences</a> of this decision.
        <!-- http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/315237
        -->
      </aside>

      <figure class=railroad>
        <img id=hash-literal.png>
        <figcaption>Syntax diagram of the hash literal
      </figure>

      <p>A <code>Hash</code> literal consists of a comma-separated
      list of key-value pairs enclosed in curly braces
      (<code>{</code>, <code>}</code>).  The key is separated from
      its value with <code>=&gt;</code>. For example: <code>{:age
        =&gt; 30, :name =&gt; 'Marlo'}</code>. If the key is a
      <code>Symbol</code> literal, the colon with which its prefixed
      may be made its suffix, and <code>=&gt;</code> can be omitted.
      The previous example can be rewritten as <code>{age: 30, name:
        'Marlo'}</code>. (This syntactical shortcut is a reason for
      preferring <code>Symbol</code> keys).</p>
      
      <figure class=railroad>
        <img id=hash-member.png>
        <figcaption>Syntax diagram of an element of the hash literal
      </figure>
        
      <p>A value may be retrieved for a given key with
      <code>Hash#[<var>key</var>]</code>. A value may be associated with a given
      key with <code>Hash#[<var>key</var>] = <var>value</var></code>. Note that
      as keys are unique, associating a value with an existing key will delete
      its previous value. A key’s existence may be determined
      with <code>Hash#key?(<var>key</var>)</code>.
      
      <p>Hashes can be iterated over with <code>Hash#each</code>, which yields a
      key and its associated value on each iteration. Alternatively,
      <code>Hash#each_key</code> and <code>Hash#each_value</code> iterate over
      the keys or values, respectively.
      
      <p>Uses include a dictionary, allowing values to be looked up by key; a
      dispatch table, where the values are <code>Proc</code>s identified by
      their key; and a cache of unique values, taking advantage of the unique
      keys property.
      
      <p><code>Hash</code> is <code>Enumerable</code>, <!-- link --> so all
      <code>Enumerable</code> methods are available as well.
    </section>

    <section>
      <h1 id=regexps>Regexps</h1>
        
      <p>A <code>Regexp</code> represents a pattern that describes a
      <code>String</code>. It <i>matches</i> when contained by the former. The
      literal is of the form
      <code>/<var>pattern</var>/<var>options</var></code>: a pattern delimited
      by solidi, followed by zero or more option specifiers.</p>
      
      <!-- TODO: EBNF for regexp... -->
      <figure class=railroad>
        <img class=left id=regexp-options.png>
        <img class=inline id=regexp-literal.png>
        <figcaption>Syntax diagram of the regexp literal
      </figure>
      
      <p>The pattern consists of literal characters and meta-characters. A
      literal character is a non-meta-character; it matches itself. Prefixing a
      meta-character with a reverse solidus causes it to match literally.
      <!-- List the meta-characters explicitly? -->
      
      <p>A balanced pair of parentheses are meta-characters which group and/or
      capture the characters they enclose. Grouping allows the enclosed to be
      treated as an atomic whole such that meta-characters directly following
      the closing parenthesis act on the whole. Capturing is the extraction of
      specific parts of the text being matched so it can be referred to later,
      from within the pattern <!-- Mention backreferences? --> or the
      surrounding program. Parentheses do not capture if the opening parenthesis
      is directly followed by <code>?:</code>. Captures can be referred to by
      name if the opening parenthesis is followed by
      <code>?&lt;<var>name</var>&gt;</code>.  Alternatively, they can be
      referred to by number, where the <var>n</var><sup>th</sup> group of
      parentheses is numbered <var>n</var>.
      
      <p>A literal character or parenthetical may be followed by a quantifier
      meta-character which specifies how many consecutive occurrences are
      required at that point in the pattern. <code>+</code> requires at least
      one, <code>*</code> zero or more, and
      <code>{<var>min</var>,<var>max</var>}</code> between <var>min</var> and
      <var>max</var> times. <!-- Note that one of these can be omitted? -->
      
      <p>A character class specifies a set of characters, one of which must
      appear at that point in the pattern, enclosed within a pair of square
      brackets. The characters are specified literally, one after the other. A
      range of consecutive characters may be abbreviated with the notation
      <code><var>start</var>-<var>end</var></code>: the first character in the
      range separated from the last by a hyphen. Inside a character class the
      hyphen is therefore a metacharacter, so to be matched literally must
      appear immediately before the right square bracket.
      
      <p>There are pre-defined character classes to match alphabetical
      characters (<code>[[:alpha:]]</code>), lowercase
      (<code>[[:lower:]]</code>), uppercase (<code>[[:upper:]]</code>),
      alphanumerics (<code>[[:alnum:]]</code>), digits
      (<code>[[:digit:]]</code>), whitespace (<code>[[:space:]]</code>), and
      punctuation (<code>[[:punct:]]</code>), among others. The period matches
      any character except newline.
      
      <p>A vertical line is a meta-character specifying that either the
      expression to its right, or that to its left, must match. It is usually used
      inside a parenthetical.
      
      <p><code>String#match</code> returns a <code>MatchData</code> object if
      the match succeeded; <code>nil</code> otherwise. <code>MatchData#[]</code>
      returns the text captured by the capture group given as a
      <code>Symbol</code>, for a named group, or an <code>Integer</code>.
       
      <!-- String#gsub? -->
    </section>

    <section>
      <h1 id=ranges>Ranges</h1>
      
      <p>A <code>Range</code> represents a sequence between two
      given values.  It is either <i>inclusive</i> or
      <i>exclusive</i>: the former includes the endpoint; the latter
      does not. For example, 0–9 is a range consisting of all
      single-digit integers, expressed by specifying the start-point
      and endpoint.</p>

      <aside class=sidenote>
        <span class=sidemark>†</span>In the conditional of a branching or looping
          statement, two or three consecutive periods don’t create a
          range; they constitute a <a href=/flow#flip-flop>Boolean
            flip-flop</a>.
      </aside>
      
      <p>A <code>Range</code> literal consists of two values separated by
      two or three periods<sup>†</sup>: the former range is inclusive; the
      latter exclusive. For example, <code>'a'...'z'</code> represents
      letters <i>a</i>–<i>y</i>.</p>
      
      <figure class=railroad>
        <img id=range-literal.png>
        <figcaption>Syntax diagram of the range literal
      </figure>
       
      <p>The start-point and endpoint must be comparable <!-- link
      --> with <code>#&lt;=&gt;</code>. That is, for a range
      <code><var>start</var>..<var>end</var></code>,
      <code><var>start</var> &lt;=&gt; <var>end</var></code> must
      return -1, 0, or 1.
      <code>Range#include?(<var>object</var>)</code> allows ranges
      to be used as intervals: returning <code>true</code> if
      <var>object</var> is a member; <code>false</code> otherwise.  
      
      <p>A range is <dfn title="discrete ranges">discrete</dfn> if
      it begins with a value that responds to <code>#succ</code> by
      returning the next element of the sequence. It is so called
      because it represents a finite set of values that can be
      iterated over with <code>Range#each</code>.  Alternatively,
      <code>Range#step(<var>n</var>) {|<var>el</var>| }</code>
      passes each <var>n</var><sup>th</sup> element to the
      block. As <code>Range</code>s are <code>Enumerable</code>, they
      can also be converted to an <code>Array</code> with
      <code>Range#to_a</code>. 
       
      <p>A non-discrete range is <dfn title="continuous
        range">continuous</dfn>.  It represents an infinite set of
      values, therefore a <code>TypeError</code> is raised when
      attempting to iterate over it.
    </section>

    <section>
      <h1 id=procs><code>Proc</code>s</h1>
           
      <p>A block literal creates a <code>Proc</code> object which
      accepts the arguments provided in the optional parameter list
      and represents a sequence of zero or more statements. Unlike
      the other literals in this section, block literals must not
      appear in the top-level context; they must either terminate a
      message expression, an appropriate keyword expression, or
      lambda literal.</p> <!-- Is this restriction accurate? --> 
      
        <!-- TODO: Block local variable declarations -->
      <figure class=railroad>
        <img id=required-parameters.png>
        <img id=optional-parameter.png>
        <img id=optional-parameters.png>
        <div style=width:590px class=centre>
          <img class=inline id=rest-parameter.png>
          <img class=inline id=block-parameter.png>
        </div>
        <img id=parameter-list.png>
        <img id=block.png>
        <img id=block-literal.png>
        <figcaption>Syntax diagram of the block literal
      </figure>

      <section>
        <h1 id=lambdas>Lambdas</h1>
        
        <p>A literal of the form
        <code>-&gt;(<var>parameter<sub>0</sub></var></code>…<code><var>parameter<sub>n</sub></var>)
          { <var>statements</var> }</code> instantiates a <code>Proc</code>
        object with lambda characteristics. The parameter list takes the
        same form as that used in method definitions <!-- link -->. It may
        be omitted entirely.  <var>statements</var> is zero or more
        statements. For example, <code>-&gt; { 42 }</code>, or
        <code>-&gt;(a, b) { a + b }</code>.</p>

        <figure class=railroad>
          <img id=lambda-literal.png>
          <figcaption>Syntax diagram of the lambda literal
        </figure>
      </section>
    </section>

    <section>
      <h1 id=immediates>Immediates</h1> <!-- sidebar this? -->

      <p><code>Symbol</code> and <code>Fixnum</code> literals are
      <dfn title=immediates>immediate</dfn> values. They are stored
      as values rather than object references so are immutable and
      cannot have singleton methods defined on them.
    </section>
  </section>
</section>
