<a href=/examples/case-statement-fig.rb><pre class=syntax><code><span class="no">MAX_REDIRECTS</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">redirects</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">404</span><span class="p">,</span> <span class="mi">408</span><span class="p">,</span> <span class="mi">302</span><span class="p">,</span> <span class="mi">500</span><span class="o">].</span><span class="n">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">status_code</span><span class="o">|</span>
  <span class="k">case</span> <span class="n">status_code</span>
    <span class="k">when</span> <span class="mi">408</span><span class="p">,</span> <span class="mi">504</span>  <span class="k">then</span> <span class="ss">:timeout</span>
    <span class="k">when</span> <span class="mi">100</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="mi">200</span> <span class="k">then</span> <span class="ss">:informational</span>
    <span class="k">when</span> <span class="mi">200</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="mi">300</span> <span class="k">then</span> <span class="ss">:success</span>
    <span class="k">when</span> <span class="mi">300</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="mi">400</span>
      <span class="p">(</span><span class="n">redirects</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="no">MAX_REDIRECTS</span> <span class="p">?</span> <span class="ss">:redirection</span> 
                                       <span class="p">:</span> <span class="p">(</span><span class="k">raise</span> <span class="s2">&quot;Redirection limit exceeded&quot;</span><span class="p">)</span>
    <span class="k">when</span> <span class="mi">400</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="mi">500</span> <span class="k">then</span> <span class="ss">:client_error</span>
    <span class="k">when</span> <span class="mi">500</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="mi">600</span> <span class="k">then</span> <span class="ss">:server_error</span>
    <span class="k">else</span>                <span class="k">raise</span> <span class="s2">&quot;Invalid status code: </span><span class="si">#{</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
<span class="k">end</span> <span class="c1">#=&gt; [:success, :client_error, :timeout, :redirection, :server_error]</span>
</code></pre>
</a>