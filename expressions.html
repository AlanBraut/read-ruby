<!DOCTYPE html>
<!-- vim: set fdm=indent tw=78: --> 
<title>Expressions - Read Ruby</title>
<meta charset="utf-8"/>
<!-- <script src="http://html5-now.appspot.com/base2-legacy.js"></script> 
<script src="http://html5-now.appspot.com/html5-now.js"></script>
-->
<link href=/style rel=stylesheet>
<link rel=license href=//creativecommons.org/licenses/by-nc-sa/2.0/uk/>
<link rel=next href=/messages>
<link rel='index up' href=/toc>

<section>  
  <h1 id=expressions>Expressions</h1>

  <p>An expression is a <a href=#literals>literal</a>, an <a
    href=#identifiers>identifier</a>, an assignment expression, a <a
    href=/messages#expression-syntax>message expression</a>, a
  <a href=#keywords>keyword expression</a>, or a parenthesized expression.</p>

  <section>
    <h1 id=literals>Literals</h1>
      
    <!-- Discuss &:sym as a literal? -->
    <p>An <dfn title=literal>object literal</dfn> is a syntactical shortcut
    for the instantiation of a particular core object.</p> <!-- Doesn’t call
    initialize; Performance pips pedagogy --> <!-- Cover block literals? -->

    <section>
      <h1 id=strings>Strings</h1>
       
      <p><code>String</code>s are mutable sequences of characters with
      an associated encoding.</p>

      <section>
        <h1 id=character>Character</h1>
      
        <figure class=railroad>
          <img id=character-literal.png>
          <figcaption>Syntax diagram of the character literal
        </figure>

        <p>A single character prefixed with a question mark
        (<code>?<var>char</var></code>) instantiates a <code>String</code>
        comprising the character.
      </section>
      
      <!-- TODO: alternative delimiters-->

      <section>
        <h1 id=single-quoted-strings>Single-Quoted Strings</h1>
        
        <figure class=railroad>
          <img id=single-quoted-string-literal.png>
          <figcaption>Syntax diagram of the single-quoted string literal
        </figure>
        
        <p>A single-quoted <code>String</code> is a string delimited by
        U+0027 APOSTROPHE (<code>'</code>) characters or <a
          href=#single-quoted-strings-q><code>%q</code></a>. Its
        contents are not subject to <a
          href=#string-interpolation>interpolation</a>. The only
        recognised <a href=#string-escapes>escape sequences</a> are
        <code>\\</code> and <code>\<var>delimiter</var></code>; any
        other escape is interpreted literally, i.e. as a reverse solidus
        followed by a single character.</p>
         
        <section>
          <h1 id=single-quoted-strings-q>Alternative Delimiters</h1>
          
          <figure class=railroad>
            <img id=single-quoted-string-literal-q.png>
            <figcaption>Syntax diagram of the <code>%q</code>
            single-quoted string literal
          </figure>
          
          <p>A single-quoted string may also be delimited by arbitrary
          delimiters with the
          <code>%q<var>delimiter</var>…<var>delimiter</var></code> construct,
          where <var>delimiter</var> is a single character.  If
          <var>delimiter</var> appears in the string it must be escaped.
          
          <p>If the opening delimiter is <code>(</code>, <code>[</code>,
          <code>&lt;</code>, or <code>{</code>, the closing delimiter must be
          the corresponding closing bracket. For example, if the opening
          delimiter is <code>[</code>, the closing delimiter must be
          <code>]</code>. When these paired delimiters are used, the same pair
          may appear inside the string as long as they are properly
          balanced.</p>
           
          <figure id=single-quoted-string-literal-q.rb>
            <figcaption>Constructing a single-quoted string with alternative
            delimiters using <code>%q</code>
          </figure>
        </section>
      </section>
      
      <section>
        <h1 id=double-quoted-strings>Double-Quoted Strings</h1>
        
        <figure class=railroad>
          <img id=double-quoted-string-literal.png>
          <figcaption>Syntax diagram of the double-quoted string literal
        </figure>
        
        <p>A double-quoted <code>String</code> is a <code>String</code>
        delimited with U+0022 QUOTATION MARK (<code>"</code>) characters or <a
          href=#double-quoted-strings-q><code>%Q</code></a>. Its contents are
        subject to <a href=#string-interpolation>interpolation</a> and <a
          href=#string-escapes>character escapes</a>.</p>
        
        <section>
          <h1 id=string-interpolation>String Interpolation</h1>
          
          <figure class=railroad>
            <img id=string-interpolation.png>
            <figcaption>Syntax diagram of the string interpolation
            construct
          </figure>
          
          <p><dfn title="string interpolation">Interpolation</dfn> is
          the embedding of the value of an expression within a string.
          The general form of the syntax is
          <code>#{<var>expression</var>}</code>.  It is common for
          <var>expression</var> to be simply the name of a local
          variable which is to be substituted for its value.
          
          <p>The braces can be omitted if <var>expression</var> is the
          name of a global—, class—, or instance variable. However, in
          this case the variable name cannot be immediately followed by
          a character legal in an identifier, as ambiguity results. </p>
        </section>

        <section>
          <h1 id=string-escapes>String Escapes</h1>
           
          <figure class=railroad>
            <img id=escape.png>
            <figcaption>Syntax diagram of the string escape
          </figure>
           
          <p><dfn title="backslash escape">Escape sequences</dfn> are
          character sequences prefixed with a U+005C REVERSE SOLIDUS
          (<code>\</code>) (“backslash”) that have a meaning other than their
          constituent characters.</p>
           
          <section>
            <h1 id=character-escapes>Character Escapes</h1>

            <figure class=railroad>
              <img id=character-escape.png>
              <figcaption>Syntax diagram of the string escape
            </figure>

            <p>A character escape consists of a reverse solidus followed by a
            single character, <var>char</var>. If <var>char</var> is one of
            [<code>abcefnrstuvxCM01234567</code>], the escape has the meaning
            given in the table below. If <var>char</var> is a literal line
            terminator (i.e. U+000A &lt;control&gt;, U+000D &lt;control&gt;,
            or U+000D&nbsp;&lt;control&gt;U+000A&nbsp;&lt;control&gt;), both
            the reverse solidus and the line terminator are removed from the
            string. In all other cases <code>\<var>char</var></code> evaluates
            to <var>char</var>.</p>

            <figure id=character-escape.rb>
              <figcaption>A character escape is a reverse solidus followed by
              a single character
            </figure>
          </section>

          <section>
            <h1 id=byte-escapes>Byte Escapes</h1>

            <figure class=railroad>
              <!-- TODO: Incorporate maximumn value of octal integer: 377
              -->
              <img id=byte-escape.png>
              <figcaption>Syntax diagram of the byte escape
            </figure>

            <section>
              <h1 id=octal-byte>Octal Byte Escapes</h1>

              <p>A reverse solidus followed by an octal number between zero
              and 377<sub>8</sub> represents the character whose character
              code that is.</p>

              <figure id=octal-byte-escape.rb>
                <figcaption>An octal byte escape consists of a backslash
                followed by a character code in base 8
              </figure>
            </section>

            <section>
              <h1 id=hex-byte>Hexadecimal Byte Escapes</h1>

              <p>A hexadecimal byte escape consists of <code>\x</code>
              followed by a hexadecimal number ≤ FF<sub>16</sub>. It
              represents the character whose code is given by the number.</p>

              <figure id=hex-byte-escape.rb>
                <figcaption>A hexadecimal byte escape consists of a backslash
                followed by an <code>x</code> followed by one or two
                hexadecimal digits
              </figure>
            </section>
          </section>

          <section>
            <h1 id=control-escapes>Control Escapes</h1>

            <figure class=railroad>
              <img id=control-escape.png>
              <figcaption>Syntax diagram of the control escape
            </figure>

            <p>The escape sequence for <a
            href=//en.wikipedia.org/wiki/Control_character>control
            character</a>
            <kbd><kbd>Ctrl</kbd>-<kbd><var>char</var></kbd></kbd> consists of
            a reverse solidus, either <code>c</code> or <code>C-</code>, then
            <var>char</var>, which may be a character or escape.
            (<var>char</var> must not be a <a
            href=#control-escape>control</a>, Unicode, <a
            href=#hex-byte>hexadecimal</a>, or three-digit <a
            href=#octal-byte>octal</a>, escape). Its value is the character
            whose character code is that of <var>char</var> ∧ 0x1F.</p>
            
            <figure id=control-escape.rb>
              <figcaption>The control escape represents a control key
            </figure>
          </section>

          <section>
            <h1 id=meta-escapes>Meta Character Escapes</h1>

            <figure class=railroad>
              <img id=meta-escape.png>
              <figcaption>Syntax diagram of the meta character escape
            </figure>

            <p>The meta character escape <code>\M-<var>char</var></code>
            represents the character whose character code is that of
            <var>char</var> ∨ 0x80, where <var>char</var> is a single
            character or escape. (<var>char</var> must not be a <a
            href=#meta-escape>meta character</a>, Unicode, <a
            href=#hex-byte>hexadecimal</a>, or three-digit <a
            href=#octal-byte>octal</a>, escape).</p>

            <figure id=meta-escape.rb>
              <figcaption>The meta character escape represents the given meta
              character.
            </figure>
          </section>

          <section>
            <h1 id=unicode-escapes>Unicode Escapes</h1>
               
            <figure class=railroad>
              <img id=unicode-escape.png>
              <figcaption>Syntax diagram of the Unicode <code>\u</code>
              escape
            </figure>
            
            <p>An arbitrary <a
            href=//en.wikipedia.org/wiki/Unicode>Unicode</a> character may be
            embedded in a string by specifying its <a
            href=//en.wikipedia.org/wiki/Codepoint>codepoint</a> as four
            hexadecimal digits following <code>\u</code>.            

            <p>The <code>\u{}</code> construct extends this ability to
            embedding multiple codepoints with the same escape.
            The curly braces delimit one or more hexadecimal codepoints
            separated by whitespace. This form does not restrict a
            codepoint to four digits.</p>             

            <figure class=railroad>
              <img id=hex-codepoint.png>
              <figcaption>Syntax diagram of a Unicode codepoint in hexadecimal
            </figure>

            <p>Both escapes above force the string in which they are
            embedded to have UTF-8 encoding. However, they are illegal
            in a file that has both a non-UTF-8 source encoding and
            a string containing literal multibyte characters in that
            encoding.</p>

            <figure id=unicode-escape.rb>
              <figcaption>A Unicode escape represents a Unicode character with
              the given codepoint(s)
            </figure>
          </section>

          <table class=border>
            <thead>
              <tr><th>Escape Sequence<th>Interpretation
            </thead>
            <tbody>
              <tr class=odd>
                <td><code>\a</code>
                <td>U+0007 &lt;control&gt;: The <a
                    href=//en.wikipedia.org/wiki/Bell_character>BEL</a>
                    character. Rings the console bell.
              <tr>
                <td><code>\b</code>
                <td>U+0008 &lt;control&gt;: The <a
                    href=//en.wikipedia.org/wiki/Backspace>Backspace</a>
                    character.
              <tr class=odd>
                <td><code>\e</code>
                <td>U+001B &lt;control&gt;: The <a
                    href=//en.wikipedia.org/wiki/Esc>ESC</a>
                    character.
              <tr>
                <td><code>\f</code>
                <td>U+000C &lt;control&gt;: The <a
                    href=//en.wikipedia.org/wiki/Form_feed>Form Feed</a>
                    character.
              <tr class=odd>
                <td><code>\n</code>
                <td>U+000A &lt;control&gt;: The <a
                    href=//en.wikipedia.org/wiki/Newline>Newline</a> character.
              <tr>
                <td><code>\r</code>
                <td>U+000D &lt;control&gt;: The <a
                    href=//en.wikipedia.org/wiki/Carriage_return>Carriage Return</a> 
                  character.
              <tr class=odd>
                <td><code>\s</code>
                <td>U+0020 SPACE: The <a
                    href=//en.wikipedia.org/wiki/Space_key>Space</a>
                  character.
              <tr>
                <td><code>\t</code>
                <td>U+0009 &lt;control&gt;: The <a
                    href=//en.wikipedia.org/wiki/Tab_character>Tab</a> 
                  character
              <tr class=odd>
                <td><a
                href=#unicode-escapes><code>\u<var>hex</var><var>hex</var><var>hex</var><var>hex</var></code></a>
                  <td>The Unicode codepoint specified by the four given
                  hexadecimal digits.
              <tr>
                <td><a
                href=#unicode-escapes><code>\u{<var>codepoints</var>}</code></a>
                <td>The Unicode codepoint(s) specified by
                  <a href=#unicode-escapes><var>codepoints</var></a>.
              <tr class=odd>
                <td><code>\v</code>
                <td>U+000B &lt;control&gt;: The vertical tab character.
              <tr>
                <td><a
                href=#octal-byte><code>\<var>octal</var><var>octal</var><var>octal</var></code></a>
                <td>The byte specified by the three given octal digits,
                  whose combined value does not exceed 377<sub>8</sub>.
              <tr class=odd>
                <td><a
                href=#octal-byte><code>\<var>octal</var><var>octal</var></code></a>
                <td>The byte specified by the two given octal digits.
              <tr>
                <td><a href=#octal-byte><code>\<var>octal</var></code></a>
                <td>The byte specified by the given octal digit.
              <tr class=odd>
                <td><a
                href=#hex-byte><code>\x<var>hex</var><var>hex</var></code></a>
                <td>The byte specified by the two given hexadecimal
                  digits.
              <tr>
                <td><a href=#hex-byte><code>\x<var>hex</var></code></a>
                <td>The byte specified by the given hexadecimal digit.
              <tr class=odd>
                <td><a
                href=#control-escapes><code>\c<var>char</var></code></a>
                <td rowspan=2>The control character
                <kbd><kbd>Ctrl</kbd>-<kbd><var>char</var></kbd></kbd>.
              <tr class=odd>
                <td><a
                href=#control-escapes><code>\C-<var>char</var></code></a>
              <tr>
                <td><a href=#meta-escapes><code>\M-<var>char</var></code></a>
                <td>Meta character <var>char</var>.
              <tr class=odd>
                <td><code>\</code>U+000A &lt;control&gt;
                <td rowspan=3>A backslash before a <a
                    href=//en.wikipedia.org/wiki/Newline>line terminator</a>
                  escapes it, removing both the line
                  terminator and backslash from the string
              <tr class=odd>
                <td><code>\</code>U+000D &lt;control&gt;
              <tr class=odd>
                <td><code>\</code>U+000D&nbsp;&lt;control&gt;U+000A&nbsp;&lt;control&gt;
              <tr>
                <td><code>\<var>char</var></code>
                <td>A backslash before any other character evaluates to
                  the character itself
            </tbody>
          </table>
        </section>

        <section>
          <h1 id=double-quoted-strings-q>Alternative Delimiters</h1>
          
          <figure class=railroad>
            <img id=double-quoted-string-literal-q.png>
            <figcaption>Syntax diagram of the <code>%Q</code>
            double-quoted string literal
          </figure>
          
          <p>A double-quoted string may also be delimited by arbitrary
          delimiters with the
          <code>%Q<var>delimiter</var>…<var>delimiter</var></code> and
          <code>%<var>delimiter</var>…<var>delimiter</var></code>constructs,
          where <var>delimiter</var> is a single character.  If
          <var>delimiter</var> appears in the string it must be escaped.
           
          <p>If the opening delimiter is <code>(</code>, <code>[</code>,
          <code>&lt;</code>, or <code>{</code>, the closing delimiter
          must be the corresponding closing bracket. For example, if the
          opening delimiter is <code>[</code>, the closing delimiter
          must be <code>]</code>. When these paired delimiters are used,
          the same pair may appear inside the string as long as they are
          properly balanced.</p>
            
          <figure id=double-quoted-string-literal-q.rb>
            <figcaption>Constructing a double-quoted string with
            alternative delimiters using <code>%Q</code>
          </figure>
        </section>
      </section>
      
      <p>Therefore, a <dfn>string literal</dfn> is either a double-quoted
      string literal or a single-quoted string literal.</p>
      
      <figure class=railroad>
        <img id=string-literal.png>
        <figcaption>Syntax diagram of the string literal
      </figure>
       
      <section>
        <h1 id=here-documents>Here Documents</h1>
        
        <figure class=railroad>
          <img id=here-doc.png>
          <figcaption>Syntax diagram of the here document
        </figure>
         
        <p><dfn>Here documents</dfn> extend the concept of alternative
        delimiters to allow an arbitrary <em>sequence</em> of characters
        as a delimiter. They begin with <code>&lt;&lt;</code> followed
        immediately by an arbitary identifier or string literal. Their
        content begins on the following line and continues until that
        same identifier/string is seen on a line by itself with no
        intervening whitespace. If there is a hyphen between the
        opening <code>&lt;&lt;</code> and the delimiter, i.e.
        <code>&lt;&lt;-<var>delimiter</var></code>, the closing
        delimiter may be preceded with whitespace. The final newline
        character before the closing delimiter is part of the here
        document’s contents: a minimal here document is equivalent to
        <code>"\n"</code>.
        
        <p>If the delimiter is an identifier or double quoted string,
        the contents of the here document is interpreted with
        double-quoted string semantics. Otherwise, the here document’s
        contents are interpreted literally: all escape sequences and
        interpolation constructs are ignored.</p>
        
        <figure id=here-doc.rb>
          <figcaption>Using a here document to render a poem
        </figure>
      </section>

      <section>
        <h1 id=backticks>Backticks</h1>
          
        <p>A double-quoted string delimited with U+0060 GRAVE ACCENT
        (<code>`</code>) characters, or “backticks”, executes its
        contents as an operating system command and returns the output.
        This is achieved by the <code>Kernel.`</code> method, which can
        be redefined to alter these semantics. Alternative delimiters
        can be used with the corresponding
        <code>%x<var>delimiter</var>…<var>delimiter</var></code>
        construct, which follows the same rules as <a
          href=#double-quoted-strings-q><code>%Q</code></a>.</p>
        
        <figure id=backticks.rb>
          <figcaption>Using backticks to execute commands and retrieve
          the output
        </figure>
      </section>

      <!-- TODO: Snip below paragraph? -->
      <p>A string may be iterated over by Unicode codepoint with
      <code>String#codepoints</code>, byte with <code>String#bytes</code>,
      character with <code>String#chars</code>, or line with
      <code>String#lines</code>.</p>
    </section>
      
    <section>
      <h1 id=symbols>Symbols</h1>

      <figure class=railroad>
        <img class=left id=operator-method-selector.png>
        <img class=left id=non-symbol-character.png>
        <img class=inline id=symbol.png>
        <!-- TODO: Exclude \0 -->
        <!-- TODO: Look for other exceptions to this rule -->
        <img class=inline id=symbol-literal.png>
        <figcaption class=clear>Syntax diagram of the symbol literal
      </figure>

      <p>A <code>Symbol</code> represents a name.
      <code>Symbol</code>s are immutable immediates. Two symbols
      with the same content will always be represented by the same
      object, e.g. <code>:glark.object_id ==
        :glark.object_id</code>, so symbol comparisons are extremely
      efficient.  However, <code>Symbol</code> objects are not
      garbage collected, so are unsuitable for storing data from
      unbounded collections; use <code>String</code>s instead.
      
      <p><code>Symbol</code>s are used for unique identifiers, such
      as <code>Hash</code> keys, as message selectors and method
      names, and as a substitute for constants.

      <p>A <code>Symbol</code> literal consists of a colon followed
      by an symbol or <code>String</code> literal, e.g.
      <code>:roland_barthes</code> or <code>:'887'</code>.
      The <code>%s<var>delimiter</var>…<var>delimiter</var></code>
      construct enables symbols to be specified between arbitrary
      delimiters along the same lines as <a
        href=#single-quoted-strings-q><code>%q</code></a>.

      <!-- #to_sym -->
    </section>

    <section>
      <h1 id=numerics>Numerics</h1>
      <!-- Are immediates _instantiated_? -->
                 
      <p>A decimal integer literal consists of an optional sign
      (<code>+</code> or <code>-</code>) followed by one or more decimal
      digits. Implementation limits dictate whether its a <code>Fixnum</code>
      or <code>Bignum</code>, but the distinction can be ignored by treating
      both as <code>Integer</code>s.</p>
       
      <figure class=railroad>
        <div class=centre style=width:467px>
          <img style=display:inline id=digit.png>
          <img style=display:inline id=non-zero-digit.png>
          <img style=display:inline id=plus-minus.png>
        </div>
        <img id=decimal-literal.png>
        <figcaption>Syntax diagram of the decimal literal
      </figure>
       
      <p>Hexadecimal, octal, and binary literals allow integers to be
      expressed in base sixteen, eight, or two, respectively. A hexadecimal
      literal begins with <code>0x</code>, and is followed by one or more hex
      digits (0–9, a–f). An octal literal begins with <code>0o</code>, and is
      followed by one or more octal digits (0–7). A binary literal begins with
      <code>0b</code>, and is followed by one or more binary digits (0–1). All
      forms ignore case and create <code>Integer</code> objects.</p>
       
      <figure class=railroad>
        <img style=float:left id=hex-digit.png>
        <img style=float:left id=octal-digit.png>
        <img id=hexadecimal-literal.png>
        <img id=binary-literal.png>
        <img id=octal-literal.png>
        <br style=clear:both>
        <figcaption>Syntax diagrams of the hexadecimal, binary, and
        octal literals
      </figure>
       
      <p>A floating-point literal consists of two integer literals
      separated with a period, e.g. <code>3.14</code>. It is of
      class <code>Float</code>.</p>
      <!-- Notes on the inacuracy of floats -->
      
      <figure class=railroad>
        <img id=float-literal.png>
        <figcaption>Syntax diagram of the floating-point literal
      </figure>
      
      <p>A scientific notation literal consists of a coefficient
      (<var>a</var>: a decimal or <code>Float</code> literal),
      <code>e</code> or <code>E</code>, then an exponent
      (<var>e</var>: a decimal literal). Its value is
      <code><var>a</var> × 10<sup><var>e</var></sup></code>
      represented as a <code>Float</code>.</p>
      
      <figure class=railroad>
        <img id=scientific-notation-literal.png>
        <figcaption>Syntax diagram of the scientific notation literal
      </figure>
              
      <p><code>Rational</code> numbers are expressed with the
      <code>Rational(<var>numerator</var>, <var>denominator</var>)</code>
      constructor. Similarly, <code>Complex(<var>real</var>,
        <var>imaginary</var>)</code> creates a <code>Complex</code>
      object.</p>
           
      <!--        <li>Standard mathematical operations as methods
            <li><code>/</code> performs integer division
            <li>to_* 
      -->
    </section>

    <section>
      <h1 id=arrays>Arrays</h1>
       
      <!-- TODO: Determine clear way to diagram optional spaces -->
      <figure class=railroad>
        <img id=array-literal.png>
        <figcaption>Syntax diagram of the array literal
      </figure>
       
      <!-- Mention #to_a? --> <p>An <code>Array</code> instance represents an
      ordered collection of objects, which need not be homogeneous. It is
      automatically resized as elements are added or removed.</p>
      
      <figure class=railroad>
        <img id=expression-list.png>
        <figcaption>Syntax diagram of an expression list
      </figure>

      <p>An <code>Array</code> literal is a comma-separated list of
      expressions enclosed in square brackets (<code>[</code>,
      <code>]</code>). For example, <code>[1, :two, 'three']</code> creates a
      three-element <code>Array</code> object with <code>1</code> as the first
      element.</p>
        
      <section>
        <h1 id=array-literal-w>Alternative Delimiters</h1>
                  
        <p>The <code>%w<var>delimiter</var>…<var>delimiter</var></code>
        construct is a syntactical shortcut for instantiating an array
        of strings. The delimiters take the same form as those of <a
          href=#single-quoted-string-q><code>%q</code></a>. The text
        between them is split on whitespace, each substring becoming an
        element on the array. <code>%w</code> interprets its contents
        with single-quoted string semantics; its counterpart,
        <code>%W</code>, behaves in the same way using double-quoted
        string semantics.</p>
         
        <figure id=array-literal-w.rb>
          <figcaption>Creating an array of strings with the
          <code>%w</code> and <code>%W</code> constructs
        </figure>
      </section>
      
      <p>Arrays are indexed by integral subscripts, beginning with 0. If the
      subscript is negative it counts backward from the last element (i.e.
      <code>-1</code> refers to the last element).  An element with subscript
      <var>index</var> can be retrieved with
      <code>Array#[<var>index</var>]</code>. If the index doesn’t exist,
      <code>nil</code> is returned. The index can be assigned to with
      <code>Array#[<var>index</var>]=</code>. 
       
      <p>Elements are appended to an array with <code>Array#&lt;&lt;</code>;
      and prepended with <code>Array#unshift</code>.
      <code>Array#include?(<var>element</var>)</code> tests whether the array
      contains <var>element</var>. The total number of elements is returned by
      <code>Array#size</code>. <code>Array#each</code> iterates over the
      array, <code>yield</code>ing the next element each time.</p>
                
      <aside>
        <h1 id=enumerables>Enumerables</h1>
         
        <!-- Mention #to_enum? -->
        <p>Core classes such as <code>Array</code>, <code>Hash</code>, and
        <code>Range</code> mixin the <code>Enumerable</code> module. Any object
        may do the same as long as its class defines an <code>#each</code> method
        which <code>yield</code>s the next element in the collection on every
        invocation.  In return, the class gains a staggering variety of methods
        for working with collections such as the following.
                
        <p><code>#map {|<var>element</var>| }</code> returns an
        <code>Array</code> created by passing each element of the collection to
        the block, then storing the result. For example, <code>[1,2,3].map{|n|
          n**2} #=&gt; [1,4,9]</code>. <!-- Symbol#to_proc ? -->
         
        <p><code>#reduce {|<var>element<sub>0</sub></var>,
          <var>element<sub>n</sub></var>| }</code> passes the first two
        elements to the block, then for each subsequent element the last
        result of the block and the element itself. For example:
        <code>[2,3,5,7].reduce(&amp;:+) =&gt; 17</code>.
         
        <p><code>#select {|<var>element</var>| }</code> returns an
        <code>Array</code> of elements for which the block returned
        <code>true</code>.
        
        <p>Lastly, <code>#any?</code>, <code>#all?</code>, and <code>#none?</code>
        accept a block which is called with an element of the collection. The
        determinative indicates how many elements of the collection the block must
        return <code>true</code> for the method to return <code>true</code>. For
        instance, <code>#any?</code> returns <code>true</code> as soon as a single
        element in the collection satisfies the block. 
         
        <!-- ruby-core: 25769 (Enumerator#next in JRuby) -->
      </aside>
    </section>

    <section>
      <h1 id=hashes>Hashes</h1>
        
      <!--<code>{phileas_fog: :jean_passepartout, bertie_wooster:
          :reginald_jeeves}</code>.-->
      
      <!-- Mention Hash#[]? -->
      <p>A <code>Hash</code> instance represents a collection of associations
      between unique keys and values (<i>key-value</i> pairs), both of which may
      be any object. It is indexed by key, and ordered by insertion. For
      instance, a <code>Hash</code> mapping colours to corresponding fruits may
      include a key-value pair of <code>:lemon =&gt; :yellow</code>:
      <code>:lemon</code> is the key; <code>:yellow</code> is the value.</p>
      
      <figure class=railroad>
        <img id=hash-literal.png>
        <figcaption>Syntax diagram of the hash literal
      </figure>

      <p>A <code>Hash</code> literal consists of a comma-separated
      list of key-value pairs enclosed in curly braces
      (<code>{</code>, <code>}</code>).  The key is separated from
      its value with <code>=&gt;</code>. For example: <code>{:age
        =&gt; 30, :name =&gt; 'Marlo'}</code>. If the key is a
      <code>Symbol</code> literal, the colon with which its prefixed
      may be made its suffix, and <code>=&gt;</code> can be omitted.
      The previous example can be rewritten as <code>{age: 30, name:
        'Marlo'}</code>. (This syntactical shortcut is a reason for
      preferring <code>Symbol</code> keys).</p>
      
      <figure class=railroad>
        <img id=hash-member.png>
        <figcaption>Syntax diagram of an element of the hash literal
      </figure>
        
      <p>A value may be retrieved for a given key with
      <code>Hash#[<var>key</var>]</code>. A value may be associated with a given
      key with <code>Hash#[<var>key</var>] = <var>value</var></code>. Note that
      as keys are unique, associating a value with an existing key will delete
      its previous value. A key’s existence may be determined
      with <code>Hash#key?(<var>key</var>)</code>.
      
      <p>Hashes can be iterated over with <code>Hash#each</code>, which yields a
      key and its associated value on each iteration. Alternatively,
      <code>Hash#each_key</code> and <code>Hash#each_value</code> iterate over
      the keys or values, respectively.
      
      <p>Uses include a dictionary, allowing values to be looked up by key; a
      dispatch table, where the values are <code>Proc</code>s identified by
      their key; and a cache of unique values, taking advantage of the unique
      keys property.
      
      <p><code>Hash</code> is <code>Enumerable</code>, <!-- link --> so all
      <code>Enumerable</code> methods are available as well.
    </section>

    <section>
      <h1 id=regexps>Regexps</h1>
        
      <p>A <code>Regexp</code> represents a pattern that describes a
      <code>String</code>. It <i>matches</i> when contained by the former. The
      literal is of the form
      <code>/<var>pattern</var>/<var>options</var></code>: a pattern delimited
      by solidi, followed by zero or more option specifiers.</p>
      
      <!-- TODO: EBNF for regexp... -->
      <figure class=railroad>
        <img class=left id=regexp-options.png>
        <img class=inline id=regexp-literal.png>
        <figcaption>Syntax diagram of the regexp literal
      </figure>
      
      <p>The pattern consists of literal characters and meta-characters. A
      literal character is a non-meta-character; it matches itself. Prefixing a
      meta-character with a reverse solidus causes it to match literally.
      <!-- List the meta-characters explicitly? -->
      
      <p>A balanced pair of parentheses are meta-characters which group and/or
      capture the characters they enclose. Grouping allows the enclosed to be
      treated as an atomic whole such that meta-characters directly following
      the closing parenthesis act on the whole. Capturing is the extraction of
      specific parts of the text being matched so it can be referred to later,
      from within the pattern <!-- Mention backreferences? --> or the
      surrounding program. Parentheses do not capture if the opening parenthesis
      is directly followed by <code>?:</code>. Captures can be referred to by
      name if the opening parenthesis is followed by
      <code>?&lt;<var>name</var>&gt;</code>.  Alternatively, they can be
      referred to by number, where the <var>n</var><sup>th</sup> group of
      parentheses is numbered <var>n</var>.
      
      <p>A literal character or parenthetical may be followed by a quantifier
      meta-character which specifies how many consecutive occurrences are
      required at that point in the pattern. <code>+</code> requires at least
      one, <code>*</code> zero or more, and
      <code>{<var>min</var>,<var>max</var>}</code> between <var>min</var> and
      <var>max</var> times. <!-- Note that one of these can be omitted? -->
      
      <p>A character class specifies a set of characters, one of which must
      appear at that point in the pattern, enclosed within a pair of square
      brackets. The characters are specified literally, one after the other. A
      range of consecutive characters may be abbreviated with the notation
      <code><var>start</var>-<var>end</var></code>: the first character in the
      range separated from the last by a hyphen. Inside a character class the
      hyphen is therefore a metacharacter, so to be matched literally must
      appear immediately before the right square bracket.
      
      <p>There are pre-defined character classes to match alphabetical
      characters (<code>[[:alpha:]]</code>), lowercase
      (<code>[[:lower:]]</code>), uppercase (<code>[[:upper:]]</code>),
      alphanumerics (<code>[[:alnum:]]</code>), digits
      (<code>[[:digit:]]</code>), whitespace (<code>[[:space:]]</code>), and
      punctuation (<code>[[:punct:]]</code>), among others. The period matches
      any character except newline.
      
      <p>A vertical line is a meta-character specifying that either the
      expression to its right, or that to its left, must match. It is usually used
      inside a parenthetical.
      
      <p><code>String#match</code> returns a <code>MatchData</code> object if
      the match succeeded; <code>nil</code> otherwise. <code>MatchData#[]</code>
      returns the text captured by the capture group given as a
      <code>Symbol</code>, for a named group, or an <code>Integer</code>.
       
      <!-- String#gsub? -->
    </section>

    <section>
      <h1 id=ranges>Ranges</h1>
      
      <p>A <code>Range</code> represents a sequence between two
      given values.  It is either <i>inclusive</i> or
      <i>exclusive</i>: the former includes the endpoint; the latter
      does not. For example, 0–9 is a range consisting of all
      single-digit integers, expressed by specifying the start-point
      and endpoint.

      <p>A <code>Range</code> literal consists of two values
      separated by two or three periods: the former range is
      inclusive; the latter exclusive. For example,
      <code>'a'...'z'</code> represents letters
      <i>a</i>–<i>y</i>.</p>
      
      <figure class=railroad>
        <img id=range-literal.png>
        <figcaption>Syntax diagram of the range literal
      </figure>
       
      <p>The start-point and endpoint must be comparable <!-- link
      --> with <code>#&lt;=&gt;</code>. That is, for a range
      <code><var>start</var>..<var>end</var></code>,
      <code><var>start</var> &lt;=&gt; <var>end</var></code> must
      return -1, 0, or 1.
      <code>Range#include?(<var>object</var>)</code> allows ranges
      to be used as intervals: returning <code>true</code> if
      <var>object</var> is a member; <code>false</code> otherwise.  
      
      <p>A range is <dfn title="discrete ranges">discrete</dfn> if
      it begins with a value that responds to <code>#succ</code> by
      returning the next element of the sequence. It is so called
      because it represents a finite set of values that can be
      iterated over with <code>Range#each</code>.  Alternatively,
      <code>Range#step(<var>n</var>) {|<var>el</var>| }</code>
      passes each <var>n</var><sup>th</sup> element to the
      block. As <code>Range</code>s are <code>Enumerable</code>, they
      can also be converted to an <code>Array</code> with
      <code>Range#to_a</code>. 
       
      <p>A non-discrete range is <dfn title="continuous
        range">continuous</dfn>.  It represents an infinite set of
      values, therefore a <code>TypeError</code> is raised when
      attempting to iterate over it.
    </section>

    <section>
      <h1 id=procs><code>Proc</code>s</h1>
           
      <p>A block literal creates a <code>Proc</code> object which
      accepts the arguments provided in the optional parameter list
      and represents a sequence of zero or more statements. Unlike
      the other literals in this section, block literals must not
      appear in the top-level context; they must either terminate a
      message expression, an appropriate keyword expression, or
      lambda literal.</p> <!-- Is this restriction accurate? --> 
      
        <!-- TODO: Block local variable declarations -->
      <figure class=railroad>
        <img id=required-parameters.png>
        <img id=optional-parameter.png>
        <img id=optional-parameters.png>
        <div style=width:590px class=centre>
          <img class=inline id=rest-parameter.png>
          <img class=inline id=block-parameter.png>
        </div>
        <img id=parameter-list.png>
        <img id=block.png>
        <img id=block-literal.png>
        <figcaption>Syntax diagram of the block literal
      </figure>

      <section>
        <h1 id=lambdas>Lambdas</h1>
        
        <p>A literal of the form
        <code>-&gt;(<var>parameter<sub>0</sub></var></code>…<code><var>parameter<sub>n</sub></var>)
          { <var>statements</var> }</code> instantiates a <code>Proc</code>
        object with lambda characteristics. The parameter list takes the
        same form as that used in method definitions <!-- link -->. It may
        be omitted entirely.  <var>statements</var> is zero or more
        statements. For example, <code>-&gt; { 42 }</code>, or
        <code>-&gt;(a, b) { a + b }</code>.</p>

        <figure class=railroad>
          <img id=lambda-literal.png>
          <figcaption>Syntax diagram of the lambda literal
        </figure>
      </section>
    </section>

    <section>
      <h1 id=immediates>Immediates</h1> <!-- sidebar this? -->

      <p><code>Symbol</code> and <code>Fixnum</code> literals are
      <dfn title=immediates>immediate</dfn> values. They are stored
      as values rather than object references so are immutable and
      cannot have singleton methods defined on them.
    </section>
  </section>

  <section>
    <h1 id=identifiers>Identifiers</h1>
    
    <p>An <dfn>identifier</dfn> is the name of a variable or constant. It
    must not contain any US-ASCII character other than the alphanumerics
    (<code>A</code>—<code>Z</code>, <code>a</code>—<code>z</code>,
    <code>0</code>–<code>9</code>) and the U+005F LOW LINE (<code>_</code>),
    or begin with a US-ASCII digit. However, it may contain any other
    character legal in the source encoding.</p>
  </section>
  
  <section>
    <h1 id=variables>Variables</h1>

    <p>A <dfn>variable</dfn> is a named storage location that holds a value.
    <!-- TODO: Employ more rigourous definition; cite source --> It is named
    with an identifier, possibly preceded by a <dfn>sigil</dfn> (a symbol
    denoting the variable’s scope):</p>

    <!-- created via assignment -->

    <dl>
      <dt><var>identifier</var>
      <dd>An identifier whose first character is a US-ASCII lowercase
      character or low line is a local variable unless preceded by one of
      the following sigils.
      <dt><code>$</code><var>identifier</var>
      <dd>An U+0024 DOLLAR SIGN (<code>$</code>) prefix denotes a global variable
      <dt><code>@</code><var>identifier</var>
      <dd>A single U+0040 COMMERCIAL AT (<code>@</code>) introduces an
      <a href=/objects#instance-variables>instance variable</a>.
      <dt><code>@@</code><var>identifier</var>
      <dd>Two consecutive U+0040 COMMERCIAL AT (<code>@</code>) symbols
      introduce a <a href=/classes#class-variables>class variable</a>.
    </dl>

    <section>
      <h1 id=constants>Constants</h1>
      
      <p>A constant is a variable whose value, once assigned, is not expected
      to change. Its constancy is not enforced by Ruby, so repeated
      assignments are legal, but cause a warning to be issued.</p>
      
      <section>
        <h1 id=constants-name>Name</h1>
        
        <p>A constant is, by definition, named with an identifier whose first
        character is an uppercase ASCII character
        (<code>A</code>—<code>Z</code>). It is a strong convention that
        constants qua constants are named entirely in US-ASCII uppercase
        letters with low lines to separate words, whereas constants used to
        name classes or modules are named in camel-case: title case with
        whitespace removed. 
      </section>

      <section>
        <h1 id=constants-references>References</h1>
        
        <figure class=railroad>
          <img id=constant-reference.png>
          <figcaption>Syntax diagram of a constant reference
        </figure>
        
        <p>A <dfn>constant reference</dfn> is an expression evaluating to the
        named constant. The simplest constant reference is a primary
        expression consisting solely of the constant’s name, e.g.
        <code>Constant</code>.

        <p>A constant reference may also be qualified by prefixing the
        constant name with the <q cite=/references#refTHOM09><dfn>scope
        operator</dfn></q> (<a href=/references#refTHOM09>Thomas et al.</a>,
        2009, pp. 336–339): two consecutive U+003A COLON (<code>:</code>)
        characters. This causes the constant to be looked up in the global
        scope.

        <p>A reference may be qualified further by preceding the scope
        operator with an expression evaluating to the <code>Class</code> or
        <code>Module</code> object in which the constant was defined.
      </section>
      
      <section>
        <h1 id=constants-scope>Scope</h1>
        
        <p>A constant defined in the context of a class or module is
        accessible throughout that context by unqualified reference. It may be
        accessed from an exterior context by qualifying its name with that of
        the defining class/module.

        <p>A constant defined in another context may be referred to
        unqualified or prefixed with the scope operator. However, it is
        illegal to define a constant in a method body as every invocation of
        the method would cause re-assignment, defeating the purpose of a
        constant.

        <p>A qualified constant name may be used as an lvalue, allowing
        constants to be defined in the context of a class or module from
        outside.
      </section>
      <!-- TODO: Note that constants are never unitialized -->
      <section>
        <h1 id=constants-initialization>Initialization</h1>

        <p>Constants only come into existence when they are assigned a value.
        Therefore a constant, unlike the other variables, is never in an
        uninitialized state. Referencing a constant that does not exist
        results in a <code>NameError</code>.
      </section>
  
      <section>
        <h1 id=constants-predefined>Predefined</h1>
  
        <p>The following table lists global constants that Ruby defines
        automatically.</p>

        <table class=border>
          <caption>Predefined global constants
          <thead>
            <tr>
              <th>Constant
              <th>Class
              <th>Meaning
          </thead>
          <tbody class=zebra>
            <tr>
              <td><code>DATA</code>
              <td><code>IO</code>
              <td>If the source file contains the line <code>__END__</code>,
              the lines that follow are accessible by reading from
              <code>DATA</code>.
            <tr>
              <td><code>FALSE</code>
              <td><code>FalseClass</code>
              <td><code>false</code>
            <tr>
              <td><code>NIL</code>
              <td><code>NilClass</code>
              <td><code>nil</code>
            <tr>
              <td><code>RUBY_COPYRIGHT</code>
              <td><code>String</code>
              <td>Copyright statement for the interpreter, e.g. <samp>ruby -
              Copyright (C) 1993-2010 Yukihiro Matsumoto</samp>.
            <tr>
              <td><code>RUBY_DESCRIPTION</code>
              <td><code>String</code>
              <td>Version number and architecture of the interpreter, e.g.
              <samp>ruby 1.9.2dev (2010-02-19 trunk 26715) [i686-linux]</samp>.
            <tr>
              <td><code>RUBY_ENGINE</code>
              <td><code>String</code>
              <td>The implementation of the interpreter, e.g.
              <samp>ruby</samp>.
              <dl class=inline>
                <dt><samp>ruby</samp>
                <dd><abbr title="Matz’s Ruby Intepreter">MRI</abbr>: official
                implementation.
                <dt><samp>rbx</samp>
                <dd><a href=//rubini.us/>Rubinius</a>.
                <dt><samp>macruby</samp>
                <dd><a href=http://www.macruby.org/>MacRuby</a>.
                <dt><samp>ironruby</samp>
                <dd><a href=//ironruby.net/>IronRuby</a>.
                <dt><samp>jruby</samp>
                <dd><a href=//jruby.org/>JRuby</a>.
                <dt><samp>maglev</samp> <!-- TODO: Confirm -->
                <dd><a href=//maglev.gemstone.com/>MagLev</a>
              </dl>
            <tr>
              <td><code>RUBY_PATCHLEVEL</code>
              <td><code>Fixnum</code>
              <td>Patch level of the interpreter, e.g. <samp>-1</samp>.
            <tr>
              <td><code>RUBY_PLATFORM</code>
              <td><code>String</code>
              <td>Platform for which the interpreter was built, e.g.
              <samp>i686-linux</samp>.
            <tr>
              <td><code>RUBY_RELEASE_DATE</code>
              <td><code>String</code>
              <td>Release date, for point releases, or build date, for
              trunk builds, of the interpreter, e.g. <samp>2010-02-19</samp>.
            <tr>
              <td><code>RUBY_REVISION</code>
              <td><code>Fixnum</code>
              <td>Revision of the interpreter, e.g. <samp>26715</samp>.
              (<abbr title="Subversion">SVN</abbr> revision number on MRI).
            <tr>
              <td><code>RUBY_VERSION</code>
              <td><code>String</code>
              <td>Version number of the interpreter, e.g. <samp>1.9.2</samp>.
            <tr>
              <td><code>STDERR</code>
              <td><code>IO</code>
              <td>Standard error stream. Initial value of
              <code>$stderr</code>.
            <tr>
              <td><code>STDIN</code>
              <td><code>IO</code>
              <td>Standard input stream. Initial value of
              <code>$stdin</code>.
            <tr>
              <td><code>STDOUT</code>
              <td><code>IO</code>
              <td>Standard output stream. Initial value of
              <code>$stdout</code>.
            <tr>
              <td><code>SCRIPT_LINES__</code>
              <td><code>Hash</code>
              <td>If assigned a <code>Hash</code>, each subsequent file loaded
              or required will create an entry in the hash, whose key is the
              filename as a <code>String</code>, and value is the file’s lines
              as an <code>Array</code> of <code>String</code>s.
            <tr>
              <td><code>TOPLEVEL_BINDING</code>
              <td><code>Binding</code>
              <td>Represents the top-level execution environment, i.e. outside
              of any class, module, method, block, or other construct.
            <tr>
              <td><code>TRUE</code>
              <td><code>TrueClass</code>
              <td><code>true</code>
          </tbody>
        </table>
      </section>
    </section>

      <!-- TODO: Scope section -->

    <section>
      <h1 id=local-variables>Local Variables</h1>
            
      <section>
        <h1 id=local-variables-name>Name</h1>
        
        <p>A local variable is named by an identifier whose first character is
        a lowercase US-ASCII character (<code>a</code>—<code>z</code>) or
        U+005F LOW LINE (<code>_</code>). Conventionally, the name consists of
        lowercase words separated by low lines.
      </section>

      <section>
        <h1 id=local-variables-scope>Scope</h1>
        
        <p>A local variable’s scope is the method or block in which it was
        initialized; outside of this scope it is undefined, its previous value
        forgotten. This scope is recursive: it continues thought any
        blocks or other constructs defined within.</p>

        <figure id=local-variables.rb>
          <figcaption>The scope of a local variable
        </figure>

        <p>A block defines its own lexical scope. Local variables defined
        within it do not persist outside of it. However, if, in the context of
        a block, a local variable is initialized with the name of one
        initialized in the enclosing scope, the variables refer to the same
        storage location: having left the block’s scope the variable’s value
        will be that which it was assigned within the block. If, instead, it
        is desired that variables defined within a block do not clash with
        those defined outside, <a href=/closures#block-local-variables>block
          local variables</a> are appropriate.</p>

        <figure id=non-block-local-variables-example.rb>
          <figcaption>Non-block-local variables defined prior to the block
          retain the value they were assigned inside the block even after
          leaving it
        </figure>
      </section>

      <section>
        <h1 id=local-variables-initialization>Initialization</h1>
        
        <p>A variable is initialized if it appears on the left-hand side
        (before the U+003D EQUALS SIGN (<code>=</code>)) of an assignment
        expression. However, this assignment expression need not actually
        execute: its mere presence is enough to create the variable. For
        example, if an assignment expression involving a local variable on the
        left-hand side appears within a branch that does not execute, the
        variable comes into existence.  Variables of this sort have the value
        <code>nil</code>.</p>

        <figure id=local-variables-assignment.rb>
          <figcaption>An assignment expression initializes a local variable
        </figure>

        <p>Attempting to use an uninitialized local variable causes the
        identifier to be interpreted as a message selector which is sent to
        the current implicit receiver. If such a method doesn’t exist a
        <code>NameError</code> is raised.</p>

        <figure id=local-variables-uninitialized.rb>
          <figcaption>Referring to an uninitialized local variable causes a
          <code>NameError</code> to be raised.
        </figure>
      </section>
       
      <p>The <code>Kernel.local_variables</code> method returns an
      <code>Array</code> of local variable names in the current scope as
      <code>Symbol</code>s.
    </section>

    <section>
      <h1 id=instance-variables>Instance Variables</h1>
            
      <section>
        <h1 id=instance-variables-name>Name</h1>
        
        <p>An instance variable is named by an identifier with a U+0040
        COMMERCIAL AT (<code>@</code>) sigil:
        <code>@<var>identifier</var></code>. Conventionally, the name consists
        of lowercase words separated by low lines.
      </section>

      <section>
        <h1 id=instance-variables-scope>Scope</h1>
        
        <p>An instance variable defined in the body of an instance method is
        accessible by every instance of that method’s receiver. Its scope is a
        specific object. By corollary, an instance variable defined outside of
        an instance method, such as in a class body, is not accessible from
        instance methods: it is, even if named identically, entirely separate. 

        <p>The above describes the typical use for instance variables, namely
        storing an object’s state, but they may also be defined inside a class
        or module body, outside of any method, in which case their scope is
        delimited by the class/module in which they were defined. The former
        are <a href=/class#class-instance-variables>class instance
        variables</a>; the latter module instance variables.
      </section>

      <section>
        <h1 id=instance-variables-initialization>Initialization</h1>

        <p>An instance variable is created by assigning to it a value. It is
        not inherited from a superclass: it exists for a given object only if
        an instance method of that object has assigned to it a value.

        <p>An uninitialized instance variable has the value <code>nil</code>,
        but its use results in a warning.
      </section>
       
      <p>The names of an object’s instance variables are returned as an
      <code>Array</code> of <code>Symbol</code>s by
      <code>Kernel#instance_variables</code> in the order they were assigned.
      <!-- http://redmine.ruby-lang.org/issues/show/2243 -->  Their values may
      be retrieved and modified from another object with
      <code>Kernel#instance_variable_get(<var>ivar</var>)</code> and
      <code>Kernel#instance_variable_set(<var>ivar</var>,
      <var>value</var>)</code>, respectively, where <var>ivar</var> is the
      variable’s name as a <code>Symbol</code>, including the <code>@</code>
      prefix. These methods should be used sparingly as they break
      encapsulation.
    </section>

    <section>
      <h1 id=globals>Global Variables</h1>
            
      <section>
        <h1 id=globals-name>Name</h1>

        <p>A global variable is named with a U+0024 DOLLAR SIGN
        (<code>$</code>) sigil: <code>$<var>identifier</var></code>.
        Conventionally, the name consists of lowercase words separated by low
        lines.

        <p>A global variable should not be defined with the same name as a
        predefined global variable, and indeed cannot if that variable is
        read-only.

        <!-- TODO: summarise naming conventions of pre-defined globals -->
      </section>

      <section>
        <h1 id=globals-scope>Scope</h1>

        <p>A global variable is accessible in every scope. Once set it refers
        to the same object wherever it is referenced.</p>

        <figure id=global-variables.rb>
          <figcaption>Global variables are accessible in every scope
        </figure>
      </section>
      
      <section>
        <h1 id=globals-initialization>Initialization</h1>

        <p>An uninitialized global variable has the value <code>nil</code>,
        although attempting to use such a variable results in a warning. The
        predefined global variables are already initialized.
      </section>

      <p>An <code>Array</code> of global variable names as
      <code>Symbol</code>s can be obtained with
      <code>Kernel.global_variables</code></p>

      <section>
        <h1 id=predefined-globals>Predefined Global Variables</h1>

        <p>Ruby predefines certain global variables automatically. They are
        summarised in the following table.</p>

        <table class=border>
          <caption>Predefined global variables
          <thead>
            <tr>
              <th>Global Variable
              <th title="Alias when the English library is required">
                <code>English</code> Name
              <th>Value
              <th>Meaning
          </thead>
          <tbody>
            <tr class=odd>
              <td><code>$*</code>
              <td><code>$ARGV</code>
              <td><code>Array</code>
              <td>Read-only alias of <code>ARGV</code>
            <tr>
              <td><code>$$</code>
              <td><code>$PID</code> / <code>$PROCESS_ID</code>
              <td><code>Fixnum</code>
              <td>ID of the current Ruby process. Read-only.
            <tr class=odd>
              <td><code>$?</code>
              <td><code>$CHILD_STATUS</code>
              <td><code>nil</code> or <code>Process::Status</code>
              <td>Exit status of the last terminated process. Read-only,
                thread-local.
            <tr>
              <td><code>$-d</code>
              <td rowspan=2>&nbsp;
              <td rowspan=2><code>true</code> or <code>false</code>
              <td rowspan=2>Whether Ruby was invoked with the
                            <code>-d</code> or <code>--debug</code> switches.  
            <tr>
              <td><code>$DEBUG</code>
            <tr class=odd>
              <td><code>$"</code>
              <td rowspan=2>&nbsp;</code>
              <td rowspan=2><code>Array</code> of <code>String</code>s
              <td rowspan=2>Absolute filenames of files loaded with
                            <code>Kernel.load</code> or 
                            <code>Kernel.require</code>. Read-only.
            <tr class=odd>
              <td><code>$LOADED_FEATURES</code>
            <tr>
              <td><code>$:</code>
              <td rowspan=3>&nbsp;</code>
              <td rowspan=3><code>Array</code> of <code>String</code>s
              <td rowspan=3>Absolute paths to directories searched by 
                            <code>Kernel.load</code> or 
                            <code>Kernel.require</code>. Read-only, but the
                            contents of the <code>Array</code> can be 
                            modified
            <tr>
              <td><code>$LOAD_PATH</code>
            <tr class=odd>
              <td><code>$-I</code>
            <tr>
              <td><code>$0</code>
              <td rowspan=2>&nbsp;</code>
              <td rowspan=2><code>String</code>s
              <td rowspan=2>Filename of the Ruby script being executed.
                            Equal to <code>-</code> if the program was read
                            from STDIN, or <code>-e</code> if
                            <code>ruby</code> was supplied with the
                            <code>-e</code> switch. 
            <tr>
              <td><code>$PROGRAM_NAME</code>
            <tr class=odd>
              <td><code>$SAFE</code>
              <td>&nbsp;</code>
              <td><code>Fixnum</code>s
              <td>Current safe level. Thread-local.
            <tr>
              <td><code>$-w</code>
              <td rowspan=3>&nbsp;</code>
              <td rowspan=3><code>true</code>, <code>false</code>, or
                            <code>nil</code>
              <td rowspan=3><code>true</code> if the <code>-v</code>, 
                            <code>-w</code>, or <code>--verbose</code> 
                            switches were supplied on the command line; 
                            <code>nil</code> if the <code>-W0</code> switch 
                            was supplied; <code>false</code>, otherwise.
                            Assigning <code>nil</code> to this variable
                            suppresses all warnings.
            <tr>
              <td><code>$-v</code>
            <tr>
              <td><code>$VERBOSE</code>
            <tr class=odd>
              <td><code>$!</code>
              <td><code>$ERROR_INFO</code>
              <td><code>Exception</code>
              <td>Inside a <code>rescue</code> clause or after the
              <code>rescue</code> modifier holds the current exception. 
              Thread-local.
            <tr>
              <td><code>$@</code>
              <td><code>$ERROR_POSITION</code>
              <td><code>Array</code> of <code>String</code>s
              <td>Inside a <code>rescue</code> clause or after the
              <code>rescue</code> modifier holds the stack trace of the
              current exception.  Thread-local.
            <tr class=odd>
              <td><code>$_</code>
              <td><code>$LAST_READ_LINE</code>
              <td><code>String</code>
              <td>Last string read by <code>Kernel.gets</code> or
              <code>Kernel.readline</code>. Thread-local, method-local.
            <tr>
              <td><code>$&lt;</code>
              <td><code>$DEFAULT_INPUT</code>
              <td><code>ARGF</code>
              <td>Read-only alias for <code>ARGF</code>.
            <tr class=odd>
              <td><code>$stdin</code>
              <td>&nbsp;
              <td><code>IO</code>
              <td>Standard input stream.
            <tr>
              <td><code>$&gt;</code>
              <td rowspan=2><code>$DEFAULT_OUTPUT</code>
              <td rowspan=2><code>IO</code>s
              <td rowspan=2>Standard output stream.
            <tr>
              <td><code>$stdout</code>
            <tr class=odd>
              <td><code>$stderr</code>
              <td>&nbsp;
              <td><code>IO</code>
              <td>Standard error stream.
            <tr>
              <td><code>$FILENAME</code>
              <td>&nbsp;
              <td><code>String</code>
              <td>Filename of the file currently being read from
              <code>ARGF</code>; <code>-</code> if <code>ARGF</code> is
              empty or reading from <code>STDIN</code>. Read-only.
            <tr class=odd>
              <td><code>$.</code>
              <td><code>$NR</code> / <code>$INPUT_LINE_NUMBER</code>
              <td><code>Fixnum</code>
              <td>Number of the last line read from the current input file
              in <code>ARGF</code>.
            <tr>
              <td><code>$/</code>
              <td rowspan=2><code>$RS</code> /
              <code>$INPUT_RECORD_SEPARATOR</code>
              <td rowspan=2><code>String</code>
              <td rowspan=2>Input record separator. Default value is
              <code>"\n"</code>. Can be set with the <code>-0</code> switch
            <tr>
              <td><code>$-0</code>
            <tr class=odd>
              <td><code>$\</code>
              <td><code>$ORS</code> / <code>$OUTPUT_RECORD_SEPARATOR</code>
              <td><code>String</code> or <code>nil</code>
              <td>Appended to <code>Kernel.print</code> output if
              non-<code>nil</code>. Default value is <code>nil</code>, or
              <code>$/</code> if the <code>-l</code> switch is given.
            <tr>
              <td><code>$,</code>
              <td><code>$OFS</code> / <code>$OUTPUT_FIELD_SEPARATOR</code>
              <td><code>nil</code> or <code>String</code>
              <td>Separator printed between the arguments of
              <code>Kernel.print</code> and the default separator of
              <code>Array.join</code>. Equal to <code>nil</code> by default.
            <tr class=odd>
              <td><code>$;</code>
              <td rowspan=2><code>$FS</code> / <code>$FIELD_SEPARATOR</code>
              <td rowspan=2><code>String</code> or <code>nil</code>
              <td rowspan=2>Default field separator of
              <code>String#split</code>. Default value is <code>nil</code>
              or the argument to the <code>-F</code> switch.
            <tr class=odd>
              <td><code>$-F</code>
            <tr>
              <td><code>$F</code>
              <td>&nbsp;
              <td><code>Array</code> of <code>String</code>s
              <td>If the <code>-a</code> and <code>-n</code>/<code>-p</code>
              switches were given, holds the return value of
              <code>String#split</code> for the current input line.
            <tr class=odd>
              <td><code>$~</code>
              <td><code>$MATCH_INFO</code>
              <td><code>MatchData</code> or <code>nil</code>
              <td><code>MatchData</code> from the last regexp match. Thread-
              and method-local.
            <tr>
              <td><code>$&amp;</code>
              <td><code>$MATCH</code>
              <td><code>String</code>
              <td>Text matched by last regexp match. Read-only. Thread- and
              method-local.
            <tr class=odd>
              <td><code>$`</code>
              <td><code>$PREMATCH</code>
              <td><code>String</code>
              <td>Text preceding the match of the last regexp match.
              Read-only. Thread- and method-local.
            <tr>
              <td><code>$'</code>
              <td><code>$POSTMATCH</code>
              <td><code>String</code>
              <td>Text following the match of the last regexp match.
              Read-only. Thread- and method-local.
            <tr class=odd>
              <td><code>$+</code>
              <td><code>$LAST_PAREN_MATCH</code>
              <td><code>String</code>
              <td>Text enclosed in the last successfully matched group of
              the last regexp match.  Read-only. Thread- and method-local.
            <tr>
              <td><code>$-a</code>
              <td>&nbsp;
              <td><code>true</code> or <code>false</code>
              <td><code>true</code> if the <code>-a</code> switch was given;
              <code>false</code> otherwise. Read-only.
            <tr class=odd>
              <td><code>$-i</code>
              <td>&nbsp;
              <td><code>true</code> or <code>false</code>
              <td>Argument of the <code>-i</code> switch, if given;
              otherwise <code>nil</code>; <code>false</code> otherwise.
            <tr>
              <td><code>$-l</code>
              <td>&nbsp;
              <td><code>true</code> or <code>false</code>
              <td><code>true</code> if the <code>-l</code> switch was given;
              <code>false</code> otherwise. Read-only.
            <tr class=odd>
              <td><code>$-p</code>
              <td>&nbsp;
              <td><code>true</code> or <code>false</code>
              <td><code>true</code> if the <code>-p</code> switch was given;
              <code>false</code> otherwise. Read-only.
            <tr>
              <td><code>$-W</code>
              <td>&nbsp;
              <td><code>Fixnum</code>
              <td>Current verbosity level: <code>0</code> if the
              <code>-W0</code> switch was given; <code>2</code> if the
              <code>-w</code>, <code>-v</code>, or <code>--verbose</code>
              switches were given; <code>1</code> otherwise. Read-only.
          </tbody>
        </table>
      </section>
    </section>
  </section>

  <section>
    <h1 id=assignment>Assignment Expressions</h1>

    <p>An assignment expression sets the value of one or more <a
    href=#lvalues>lvalues</a> to their corresponding <a
    href=#rvalues>rvalues</a>. Its general form is <code><var>lvalues</var> =
    <var>rvalues</var></code>: one or more lvalues, a U+003D EQUALS SIGN
    (<code>=</code>), then one or more rvalues.</p>

    <section>
      <h1 id=lvalues>Lvalues</h1>

      <p>An <dfn>lvalue</dfn> is a target of an assignment: an expression
      that can appear on the <em>l</em>eft-hand side of an assignment
      expression.</p>

      <section>
        <h1 id=lvalue-variable>Variables</h1>

        <p>The name of any variable is a valid lvalue. An assignment
        expression involving a variable lvalue causes the variable to take the
        value of the corresponding rvalue. This operation occurs without any
        methods being invoked or messages sent: it is inbuilt and its
        semantics cannot be overridden. 
      </section>

      <section>
        <h1 id=lvalue-constant>Constants</h1>

        <p>The name of any constant is a valid lvalue. Assignment to a
        constant has the same semantics as assignment to a variable, with two
        caveats:
          <ul>
            <li>If the constant is initialized prior to the assignment, a
            warning will be issued.
            <li>Constant assignment is illegal in the body of a method.
          </ul>
      </section>

      <section>
        <h1 id=lvalue-attribute>Attributes</h1>

        <p>A message expression of the form
        <code><var>receiver</var>.<var>selector</var></code> is a valid lvalue
        unless the last character of <var>selector</var> is U+003F QUESTION
        MARK (<code>?</code>) or U+0021 EXCLAMATION MARK (<code>!</code>). If
        the last character of <var>selector</var> is not U+003D EQUALS SIGN
        (<code>=</code>), it is set to be. Then, <var>receiver</var> is sent
        <var>selector</var> with the rvalue as its argument.

        <p>An important implication of the above is that the receiver defines
        the semantics of assignment. Typically, a selector ending with
        <code>=</code> will assign its argument to the corresponding instance
        variable, but it is free to do otherwise. However, the return value of
        an attribute assignment expression is always the rvalue; the value
        returned by the receiver is ignored.
      </section>

      <section>
        <h1 id=lvalue-element-ref>Element Reference Lvalues</h1>

        <p>An element reference expression, i.e.
        <code><var>receiver</var>[<var>expression</var>]</code> is a special
        case of <a href=#lvalue-attribute>attribute lvalues</a>. It is
        equivalent to <code><var>receiver</var>.[]=(<var>expression</var>,
        <var>rvalue</var>)</code>.
      </section>
    </section>

    <section>
      <h1 id=rvalues>Rvalues</h1>

      <p>An <dfn>rvalue</dfn> is a value being assigned: appearing on the
      <em>r</em>ight-hand side of an assignment expression. Any expression is
      a valid rvalue. The value of the expression that assigned to the
      corresponding lvalue.
    </section>

    <section>
      <h1 id=simple-assignment>Simple Assignment</h1>

      <p>A simple assignment expression consists of a single lvalue and a
      single rvalue: <code><var>lvalue</var> = <var>rvalue</var></code>. It
      sets the value of <var>lvalue</var> to <var>rvalue</var>, then returns
      <var>rvalue</var>.

      <p>If the rvalue is an <code>Array</code>, the lvalue may be followed by
      a trailing comma to set the lvalue to the first element of the rvalue,
      discarding the remaining rvalues.
    </section>

    <section>
      <h1 id=abbreviated-assignment>Abbreviated Assignment</h1>

      <p>An <dfn>abbreviated assignment</dfn> expression is a syntactical
      shortcut for an rvalue consisting of a binary operator whose operands
      are the lvalue and rvalue, respectively. It takes the following general
      form, where <var>operator</var> is one of thirteen predefined selectors
      enumerated in the table below:

      <pre><code>
      <var>lvalue</var> <var>operator</var>= <var>rvalue</var>
      </code></pre>

      <p>This is wholly equivalent to:

      <pre><code>
      <var>lvalue</var> = <var>lvalue</var> <var>operator</var> <var>rvalue</var>
      </code></pre> 

      <p>This equivalence means that the abbreviated form results in the
      lvalue being sent a message with the selector <var>operator</var> and
      the argument <var>rvalue</var>, then the result of this operation being
      assigned to <var>lvalue</var>.

      <p>The value returned by an abbreviated assignment expression is that of
      its expanded right-hand side.

      <table class=border>
        <caption>The abbreviated assignment operators
        <thead>
          <tr><th>Operator<th>Abbreviation<th>Expansion
        </thead>          
        <tbody class=zebra>
          <tr>
            <td><code>+</code>
            <td><code><var>lvalue</var> += <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> + <var>rvalue</var></code>  
          <tr>
            <td><code>-</code>
            <td><code><var>lvalue</var> -= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> - <var>rvalue</var></code>  
          <tr>
            <td><code>*</code>
            <td><code><var>lvalue</var> *= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> * <var>rvalue</var></code>  
          <tr>
            <td><code>/</code>
            <td><code><var>lvalue</var> /= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> / <var>rvalue</var></code>  
          <tr>
            <td><code>%</code>
            <td><code><var>lvalue</var> %= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> % <var>rvalue</var></code>  
          <tr>
            <td><code>**</code>
            <td><code><var>lvalue</var> **= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> ** <var>rvalue</var></code>  
          <tr>
            <td><code>&amp;&amp;</code>
            <td><code><var>lvalue</var> &amp;&amp;= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> &amp;&amp; <var>rvalue</var></code>  
          <tr>
            <td><code>||</code>
            <td><code><var>lvalue</var> ||= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> || <var>rvalue</var></code>  
          <tr>
            <td><code>&amp;</code>
            <td><code><var>lvalue</var> &amp;= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> &amp; <var>rvalue</var></code>  
          <tr>
            <td><code>|</code>
            <td><code><var>lvalue</var> |= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> | <var>rvalue</var></code>  
          <tr>
            <td><code>^</code>
            <td><code><var>lvalue</var> ^= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> ^ <var>rvalue</var></code>  
          <tr>
            <td><code>&lt;&lt;</code>
            <td><code><var>lvalue</var> &lt;&lt;= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> &lt;&lt; <var>rvalue</var></code>  
          <tr>
            <td><code>&gt;&gt;</code>
            <td><code><var>lvalue</var> &gt;&gt;= <var>rvalue</var></code>  
            <td><code><var>lvalue</var> = <var>lvalue</var> &gt;&gt; <var>rvalue</var></code>  
        </tbody>
      </table>

      <aside>
        <p>The <code>||=</code> operator gives rise to a popular idiom
        Perrotta terms a <q cite=/references#refPER10>Nil Guard</q> (<a
        href=/references#refPER10>Perrotta</a>, pp. 243–244). Its purpose is
        to assign the rvalue to the lvalue iff the lvalue is <a
        href=/flow#conditionals>false</a> (<code>false</code> or
        <code>nil</code>). That is, to initialize the lvalue only if it isn’t
        already. Perrotta describes an <a
        href=/objects#instance-variables>instance variable</a> employing this
        technique as a <q cite=/references#refPER10>Lazy Instance Variable</q>
        (<a href=/references#refPER10>Perrotta</a>, pp. 243–244).</p>

        <figure id=nil-guard.rb>
          <figcaption>Initializing a variable only if it hasn’t been already.
        </figure>
      </aside>
    </section>

    <section>
      <h1 id=parallel-assignment>Parallel Assignment</h1>

      <p>A parallel assignment expression involves multiple <a
      href=#lvalues>lvalues</a> and/or multiple <a href=#rvalues>rvalues</a>.
      The values are separated by commas.</p>

      <p>The parallel aspect of this operation is that all of the rvalues are
      evaluated, left to right, prior to assigning them. This allows the value
      of two or more variables to be swapped, as shown in the <a
      href=#parallel-assignment-equal.rb>figure below</a>.</p>

      <section>
        <h1 id=parallel-assignment-equal>Equal Number of Lvalues to Rvalues</h1>
        
        <p>When there are as many lvalues as there are rvalues, each lvalue is
        assigned the rvalue in the corresponding position on the right-hand
        side of the expression. That is, the <var>n</var><sup>th</sup> lvalue
        is assigned the <var>n</var><sup>th</sup></var> rvalue.</p>
        
        <figure id=parallel-assignment-equal.rb>
          <figcaption>Parallel assignment when there are the same number of
          terms on both sides
        </figure>
      </section>

      <section>
        <h1 id=splat>Splat Operator</h1>
        
        <!-- TODO: Mary this section with discussion of splat in Methods and
        elsewhere -->
        
        <p>Lvalues and rvalues may optionally be directly preceded by a U+002A
        ASTERISK (<code>*</code>), termed a <dfn>splat</dfn> hereafter.</p>
        
        <section>
          <h1 id=splat-lvalue>Splatting an Lvalue</h1>
          
          <p>A maximum of one lvalue may be splatted in which case it is
          assigned an <code>Array</code> consisting of the remaining rvalues
          that lack corresponding lvalues. If the rightmost lvalue is splatted
          then it consumes all rvalues which have not already been paired with
          lvalues. If a splatted lvalue is followed by other lvalues, it
          consumes as many rvalues as possible while still allowing the
          following lvalues to receive their rvalues.</p>

          <figure id=splat-lvalue.rb>
            <figcaption>A splatted lvalue greedily consumes rvalues into an
            <code>Array</code>
          </figure>

          <section>
            <h1 id=empty-splat>Empty Splat</h1>

            <p>An lvalue may consist of sole U+002A ASTERISK (<code>*</code>),
            without any associated identifier. It behaves as described above,
            but instead of assigning the corresponding rvalues to the splatted
            lvalue, it discards them.</p>

            <figure id=empty-splat.rb>
              <figcaption>An lvalue consisting of a sole asterisk greedily
              consumes the associated rvalues, then discards them
            </figure>
          </section>
        </section>

        <section>
          <h1 id=splat-rvalue>Splatting an Rvalue</h1>
          
          <p>When an rvalue is splatted it is converted to an
          <code>Array</code> with <code>Kernel.Array()</code>, the values of
          which become rvalues in their own right.
          
          <p>When given an object that does not respond to <code>:to_a</code>,
          <code>Kernel.Array()</code> returns an <code>Array</code> with that
          object as its sole element. Therefore, splatting such an object causes
          it to expand to itself, effectively a no-op.
          
          <p>However, for objects that do respond to <code>:to_a</code> with an
          <code>Array</code>, such as <code>Array</code>, <code>Hash</code>,
          <code>Range</code>, and <code>Enumerator</code>, splatting expands
          them into a list of their constituent elements.</p>
          <!-- TODO: Aside that #to_splat was previously recommended -->

          <figure id=splat-rvalue.rb>
            <figcaption>Splatting an rvalue expands it into its constituent
            elements
          </figure>
        </section>
      </section>

      <section>
        <h1 id=parallel-assignment-one-lvalue>One Lvalue, Many Rvalues</h1>
        
        <p>When multiple rvalues are assigned to a single lvalue, there is an
        <a href=#splat-lvalue>implicit splat operator</a> before the lvalue.
        Therefore, assigning <var>n</var> rvalues to a single lvalue is
        equivalent to:</p>
                
        <pre class=syntax><code>
<var>lvalue</var> = [<var>rvalue</var><sub>0</sub>,…,<var>rvalue</var><sub><var>n</var></sub>]</code></pre>
          
        <p>If this behaviour is undesirable, the lvalue can be followed by a
        trailing comma, assigning <var>rvalue</var><sub>0</sub> to
        <var>lvalue</var>, and discarding the remaining rvalues.</p>
        
        <figure id=parallel-assignment-one-lvalue.rb>
          <figcaption>Parallel assignment when there is a sole lvalue
        </figure>
      </section>

      <section>
        <h1 id=parallel-assignment-one-rvalue>Many Lvalues, One Rvalue</h1>
        
        <p>If there are multiple lvalues and a single rvalue that responds to
        <code>:to_ary</code> with an <code>Array</code>, the elements of this
        array become rvalues in their own right, replacing the original
        rvalue.</p>
        
        <figure id=parallel-assignment-one-rvalue.rb>
          <figcaption>When an <code>Array</code> with
          <var>n</var> elements is assigned to <var>n</var> lvalues, each
          lvalue is assigned one element
        </figure>

        <p>Note that <code>:to_ary</code> is sent rather than the
        <code>:to_a</code> used by the <a
          href=#splat-rvalue>splat</a> operator. In the former case,
        the programmer did not directly request that conversion take place so
        the message for <a href=/objects#implicit-conversion>implicit</a>
        conversion is sent; in the latter, his use of the splat operator
        constitutes an <a href=/objects#explicit-conversion>explicit
          conversion</a>, so the more liberal protocol is followed.</p>
        
        <figure id=parallel-assignment-rvalue-to-ary.rb>
          <figcaption>When an object responding to
          <code>:to_ary</code> with an <var>n</var> element <code>Array</code>
          is assigned to <var>n</var> lvalues, each lvalue is assigned one
          element
        </figure>
        
        <p>If there are as many lvalues as there are
        elements in the splatted rvalue, assignment proceeds according to <a
          href=#parallel-assignment-equal>Equal Number of Lvalues to
          Rvalues</a>; otherwise the following section, <a
          href=#parallel-assignment-unequal>Unequal Number of Lvalues to
          Rvalues</a>, applies.</p>

        <figure id=parallel-assignment-one-rvalue-nil.rb>
          <figcaption>When an <code>Array</code> with
          <var>n</var> elements is assigned to fewer than <var>n</var>
          lvalues, the first <var>n</var> elements are assigned the
          corresponding lvalue, and the remainder discarded
        </figure>
        
        <!--<figure class=compact id=parallel-assignment-one-rvalue-non-array.rb>
          <figcaption style=width:45%>When a non-<code>Array</code> is
          assigned to multiple lvalues, the first lvalue takes the sole
          rvalue, and the remaining lvalues are assigned <code>nil</code>
        </figure>
        <br class=clear>
        -->
      </section>

      <section>
        <h1 id=parallel-assignment-unequal>Unequal Number of Lvalues to Rvalues</h1>
        
        <p>When the lvalues outnumber the rvalues, assignment proceeds as with
        <a href=#parallel-assignment-equal>equal numbers of lvalues to
          rvalues</a>, with the remaining lvalues being assigned
        <code>nil</code>. That is, for <var>n</var> rvalues and <var>m</var>
        lvalues, where <var>n</var> &lt; <var>m</var>,
        <var>lvalue</var><sub>0</sub>–<var>lvalue</var><sub><var>n</var></sub>
        are assigned
        <var>rvalue</var><sub>0</sub>–<var>rvalue</var><sub><var>n</var></sub>,
        and
        <var>lvalue</var><sub><var>n</var>+1</sub>–<var>lvalue</var><sub><var>m</var></sub>
        are assigned <code>nil</code>.</p>

        <figure id=parallel-assignment-more-lvalues.rb>
          <figcaption>When there are more lvalues than rvalues, the
          superfluous lvalues are assigned <code>nil</code> 
        </figure>
         
        <p>Conversely, when the rvalues outnumber the lvalues, assignment
        proceeds as with <a href=#parallel-assignment-equal>equal numbers of
          lvalues to rvalues</a>, with the remaining rvalues being
        discarded.</p>

        <figure id=parallel-assignment-more-rvalues.rb>
          <figcaption>When there are more rvalues than lvalues, the
          superfluous rvalues are discarded 
        </figure>
      </section>

      <section>
        <h1 id=sub-assignment>Sub-assignment</h1>

        <p>When a group of at least two lvalues are enclosed in parentheses,
        they are initially treated as a single lvalue in that, collectively,
        they are assigned a single rvalue. After all remaining lvalues have
        been paired with their corresponding rvalues, the rules of parallel
        assignment are applied again to each of these groups, recursively for
        each level of parentheticals. 

        <p>Recall that if multiple lvalues are assigned a single rvalue that
        responds to <code>:to_ary</code>, the rvalue is assigned to the first
        lvalue, and the remaining lvalues are assigned <code>nil</code>.
        Therefore, sub-assignment is most useful when the corresponding rvalue
        is array-like, because it distributes the elements of potentially
        nested arrays on the right-hand side among lvalues.</p>

        <figure id=sub-assignment.rb>
          <figcaption>Using sub-assignment to distribute nested rvalues
        </figure>
      </section>

      <section>
        <h1 id=parallel-assignment-value>Value of a Parallel Assignment Expression</h1>

        <p>A parallel assignment expression involving a single rvalue has
        that rvalue as its value. Otherwise, the value is
        an <code>Array</code> of the rvalues, including any that were
        discarded. In both cases, the rvalues are splatted as appropriate
        before being returned.</p>

        <figure id=parallel-assignment-value.rb>
          <figcaption>The value of a parallel assignment expression is its
          rvalues
        </figure>
      </section>
    </section>
  </section>

  <section>
    <h1 id=defined><code>defined?</code></h1>

    <figure id=defined.rb>
      <figcaption>Using the <code>defined?</code> operator to test whether a
      variable or expression is defined
    </figure>

    <p><code>defined?</code> is a unary operator which tests whether its
    operand is defined, and if so returns a description of it.
    <code>nil</code> is returned if the operand is an undefined variable or
    method, an expression which uses <code>yield</code> without an
    associated block, or an expression which uses <code>super</code> without
    a corresponding superclass method. In all cases the test is conducted
    without evaluating the operand.</p>
    
    <!-- Couldn’t use nth-child selector because of rowspan -->
    <table>
      <caption>The return values of the <code>defined?</code> operator
      <thead>
        <tr><th>Operand<th>Return Value of <code>defined?</code>
      </thead>
      <tbody>
        <tr><td>Defined local variable<td><code>"local-variable"</code>
        <tr><td>Defined global variable<td><code>"global-variable"</code>
        <tr><td>Defined constant<td><code>"constant"</code>
        <tr><td>Defined instance variable<td><code>"instance-variable"</code>
        <tr><td>Defined class variable<td><code>"class variable"</code>
        <tr><td><code>nil</code><td><code>"nil"</code>
        <tr><td><code>true</code><td><code>"true"</code>
        <tr><td><code>false</code><td><code>"false"</code>
        <tr><td><code>self</code><td><code>"self"</code>
        <tr><td>Expression using <code>yield</code>
            correctly<td><code>"yield"</code>
        <tr><td>Expression using <code>super</code>
            correctly<td><code>"super"</code>
        <tr><td>Assignment expression<td><code>"assignment"</code>
        <tr><td>Message sending expression (doesn’t check arity)
             <td><code>"method"</code>
        <tr><td>Any other legal expression<td><code>"expression"</code>
        <tr><td>Undefined variable or invalid use of
            <code>yield</code>/<code>super</code>
            <td><code>nil</code>
      </tbody>
    </table>
  </section>

  <section>
    <h1 id=keywords>Keyword Expressions</h1>
    
    <dl>
      <!-- Is alias an expression given that it always returns nil? -->
      <dt><a href=/methods#aliases><code>alias</code></a> 
      <dd>Creates a copy of an existing method with a new name.
      <dt><a href=/flow#and-operator><code>and</code></a> 
      <dd>Boolean binary operator performing logical AND.
      <dt><a href=/flow#begin-statement><code>begin</code></a> 
      <dd>Introduces a block of code which may have <code>rescue</code>,
      <code>ensure</code>, and <code>else</code> clauses attached.
      <dt><a href=/flow#break-statement><code>break</code></a> 
      <dd>Within a loop or block, transfers control to the statement
      immediately following the construct.
      <dt><a href=/classes#class-keyword><code>class</code></a>
      <dd>Defines a class.
      <dt><a href=/flow#case-statement><code>case</code></a> 
      <dd>Multi-way conditional predicated on the value of a given expression.
      <!-- Is def an expression given that it always returns nil? -->
      <dt><a href=/methods#defining><code>def</code></a> 
      <dd>Defines a method
      <dt><a href=#defined><code>defined?</code></a> 
      <dd>
      <!-- NOTE: Not standalone -->
      <dt><a href=/messages#block-argument><code>do</code></a> <!-- ?? -->
      <dd>Delimits a block literal
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#if-else-clause><code>else</code></a> <!-- rescue else
      clause -->
      <dd>Optional default clause for the <code>case</code>, <code>if</code>,
      <code>unless</code> statements. Optional clause of <code>begin</code>,
      <code>class</code>, <code>def</code>, and <code>module</code> statements
      for use in exception handling.
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#if-elsif-clause><code>elsif</code></a>
      <dd>Optional clause in an <code>if</code> statement.
      <dt><a href=/flow#for><code>in</code></a> <!-- xref for in specifically?
      -->
      <dd>Separates a list of identifiers from the object being iterated in a
      <code>for</code> loop.
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#ensure-clause><code>ensure</code></a>
      <dd>Optional clause of <code>begin</code>, <code>class</code>,
      <code>def</code>, and <code>module</code> statements which is executed
      even if sibling clauses raise an exception.
      <dt><a href=/flow#false><code>false</code></a>
      <dd>Singleton instance of <code>FalseClass</code> representing
      falsehood.
      <dt><a href=/flow#for><code>for</code></a>
      <dd>Looping construct for iterating over an object responding to
      <code>:each</code>.
      <dt><a href=/flow#if-statement><code>if</code></a> <!-- postfix form, also -->
      <dd>Conditional statement and statement modifier.
      <dt><a href=/modules#module-keyword><code>module</code></a>
      <dd>Defines a module.
      <dt><a href=/flow#next-statement><code>next</code></a>
      <dd>Ends the current iteration of a loop or iterator and begins the
      next.
      <dt><a href=/flow#nil><code>nil</code></a>
      <dd>Singleton instance of <code>NilClass</code> representing the
      absence of a value.
      <dt><a href=/flow#not-operator><code>not</code></a>
      <dd>Boolean unary operator performing logical NOT. 
      <dt><a href=/flow#or-operator><code>or</code></a>
      <dd>Boolean binary operator performing logical OR.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#redo-statement><code>redo</code></a>
      <dd>Restarts the current iteration of a loop without re-evaluating the
      conditional.
      <!-- NOTE: Not standalone -->
      <dt><a href=/flow#rescue><code>rescue</code></a>
      <dd>Optional clause of <code>begin</code>, <code>class</code>,
      <code>def</code>, or <code>module</code> statements that handles the
      specified exceptions.
      <!-- NOTE: No return value? -->
      <dt><code>retry</code>
      <dd>
      <!-- return should be discussed in Flow > Control Statements -->
      <dt><a href=/methods#return-values><code>return</code></a>
      <dd>Immediately returns control from a method to its caller, along with
      an optional value.
      <dt><code>self</code>
      <dd>
      <dt><a href=/methods#super><code>super</code></a>
      <dd>When used in a method body, invokes the method from a parent class
      with the same name.
      <dt><a href=/flow#true><code>true</code></a>
      <dd>Singleton instance of <code>TrueClass</code> representing truth.
      <!-- NOTE: No return value -->
      <dt><a href=/methods#undefining><code>undef</code></a>
      <dd>Removes the definition of a given method from the class in which it
      was defined.
      <dt><a href=/flow#unless-statement><code>unless</code></a>
      <dd>Conditional statement and statement modifier.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#until-loop><code>until</code></a>
      <dd>Looping construct.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#when><code>when</code></a>
      <dd>Clause in a <code>case</code> statement.
      <!-- NOTE: No return value -->
      <dt><a href=/flow#while-loop><code>while</code></a>
      <dd>Looping construct.
      <dt><a href=/flow#yield><code>yield</code></a>
      <dd>Transfers control from a method to an associated block then back.
    </dl>
  </section>
</section>
